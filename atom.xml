<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Iamfree Blog</title>
  
  <subtitle>十年寒窗如一日，一举成名天下知</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="127.0.0.1/"/>
  <updated>2018-05-24T10:03:56.611Z</updated>
  <id>127.0.0.1/</id>
  
  <author>
    <name>Iamfree</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>基于DVWA的Xss测试平台Low等级讲解</title>
    <link href="127.0.0.1/2018/05/24/%E5%9F%BA%E4%BA%8EDVWA%E7%9A%84Xss%E6%B5%8B%E8%AF%95%E5%B9%B3%E5%8F%B0Low%E7%AD%89%E7%BA%A7%E8%AE%B2%E8%A7%A3/"/>
    <id>127.0.0.1/2018/05/24/基于DVWA的Xss测试平台Low等级讲解/</id>
    <published>2018-05-24T09:34:46.000Z</published>
    <updated>2018-05-24T10:03:56.611Z</updated>
    
    <content type="html"><![CDATA[<div class="note primary"><p>Dvwa是一个网站渗透测试演练平台，里面包括了Xss攻击,Sql注入攻击，Csrf漏洞、文件上传漏洞、命令注入漏洞等，而且每个漏洞都分为<code>Low(低等级)、Medium( 中等级 )、High( 高等级 )、Impossible( 没漏洞等级 )</code></p></div><p>下载过程和安装过程网上可以找到我就不讲解了。</p><h3 id="首先将Dvwa等级设置成Low"><a href="#首先将Dvwa等级设置成Low" class="headerlink" title="首先将Dvwa等级设置成Low:"></a>首先将<code>Dvwa</code>等级设置成<code>Low</code>:</h3><p><img src="http://static.zybuluo.com/1kbfree/xhlnfqib3ib7m5jpq5s0k9us/image_1ce8m63q6g1s5ab1ef51ilf92m9.png" alt="image_1ce8m63q6g1s5ab1ef51ilf92m9.png-135.5kB"></p><hr><h2 id="开始Xss漏洞讲解"><a href="#开始Xss漏洞讲解" class="headerlink" title="开始Xss漏洞讲解"></a>开始Xss漏洞讲解</h2><h3 id="Xss反射型："><a href="#Xss反射型：" class="headerlink" title="Xss反射型："></a>Xss反射型：</h3><p><img src="http://static.zybuluo.com/1kbfree/bzktsumqyk5cl12z0z15nojx/image_1ce8mao1la4233k77t19h21v82m.png" alt="image_1ce8mao1la4233k77t19h21v82m.png-203.8kB"><br><em>当输入<code>hello</code>在输入框点击Submit后，会输出一个<code>Hello iamfree</code>，那么我们来看看这是如何实现的</em></p><h4 id="实现的代码："><a href="#实现的代码：" class="headerlink" title="实现的代码："></a>实现的代码：</h4><p><img src="http://static.zybuluo.com/1kbfree/28z6tmahfg6x1z7reai804j1/image_1ce8n2a0ijtjgs8iitt4a1ou09.png" alt="image_1ce8n2a0ijtjgs8iitt4a1ou09.png-147.4kB"><br><em>因为这是<code>Low</code>级别的，所以我们可以清楚的看见这里没有做任何过滤，我们只需要输入一串而已的Js代码就可以实现盗取别人Cookie，做钓鱼之类的功能，下面我来简单的演示一下~</em></p><p>输入<code>&lt;img src=x onerror=alert(&#39;iamfree&#39;)&gt;</code>后，Url变成<code>http://127.0.0.1/dvwa/vulnerabilities/xss_r/?name=%3Cimg+src%3Dx+onerror%3Dalert%28%27iamfree%27%29%3E#</code>，效果:<br><img src="http://static.zybuluo.com/1kbfree/hl67ru1a4l4ltyvhi82dj0bw/image_1ce8naell1jlrkv6s1214dh7n7m.png" alt="image_1ce8naell1jlrkv6s1214dh7n7m.png-130.1kB"></p><div class="note warning"><p><code>&lt;img src=x onerror=alert(&#39;iamfree&#39;)&gt;</code>的src表示img图片的地址，可以是本地也可以是Url形式;onerror的意思是如果图片没有正常显示的话就会执行<code>=</code>后面的代码，因为这里<code>src=x</code>而<code>x</code>是不存在的，所以无法显示，就会报错了~</p></div><h3 id="如何防御"><a href="#如何防御" class="headerlink" title="如何防御"></a>如何防御</h3><p><strong>这里的话防御很简单的，只需要一个函数即可：</strong><br><img src="http://static.zybuluo.com/1kbfree/n875b1a8nh9rciqc7w66vxku/image_1ce8nikp01hm91qse12112ra2802p.png" alt="image_1ce8nikp01hm91qse12112ra2802p.png-53.3kB"></p><p><strong>防御代码:</strong><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header (<span class="string">"X-XSS-Protection: 0"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="comment">// 防御的反射Xss</span></span><br><span class="line">    $name = htmlspecialchars($_GET[<span class="string">'name'</span>]);</span><br><span class="line">    $html .= <span class="string">'&lt;pre&gt;Hello '</span> . $name . <span class="string">'&lt;/pre&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>继续访问刚才的Url(<code>http://127.0.0.1/dvwa/vulnerabilities/xss_r/?name=%3Cimg+src%3Dx+onerror%3Dalert%28%27iamfree%27%29%3E#</code>)，看看是否有效:</strong><br><img src="http://static.zybuluo.com/1kbfree/3y12i2skpud63a1qgec93sxz/image_1ce8nph771gbkh9n1v6q16p41ho736.png" alt="image_1ce8nph771gbkh9n1v6q16p41ho736.png-175.7kB"><br><em>成功的防止了Xss反射型攻击了~</em></p><h3 id="htmlspecialchars函数的官方解释"><a href="#htmlspecialchars函数的官方解释" class="headerlink" title="htmlspecialchars函数的官方解释:"></a>htmlspecialchars函数的官方解释:</h3><p><img src="http://static.zybuluo.com/1kbfree/piy4p2lkq0h81v0d1u4y5mb7/image_1ce8nug1jgbj1iib1hl91ii51vic3j.png" alt="image_1ce8nug1jgbj1iib1hl91ii51vic3j.png-137.1kB"></p><blockquote class="blockquote-center"><p>十年寒窗无人问，一举成名天下知<br>                            – Cai_Team</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;div class=&quot;note primary&quot;&gt;&lt;p&gt;Dvwa是一个网站渗透测试演练平台，里面包括了Xss攻击,Sql注入攻击，Csrf漏洞、文件上传漏洞、命令注入漏洞等，而且每个漏洞都分为&lt;code&gt;Low(低等级)、Medium( 中等级 )、High( 高等级 )、Im
      
    
    </summary>
    
      <category term="Web攻防" scheme="127.0.0.1/categories/Web%E6%94%BB%E9%98%B2/"/>
    
    
      <category term="代码审计" scheme="127.0.0.1/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="PHP" scheme="127.0.0.1/tags/PHP/"/>
    
      <category term="Dvwa" scheme="127.0.0.1/tags/Dvwa/"/>
    
  </entry>
  
  <entry>
    <title>某CTF赛的一处代码简单讲解</title>
    <link href="127.0.0.1/2018/05/24/%E6%9F%90CTF%E8%B5%9B%E7%9A%84%E4%B8%80%E5%A4%84%E4%BB%A3%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B2%E8%A7%A3/"/>
    <id>127.0.0.1/2018/05/24/某CTF赛的一处代码简单讲解/</id>
    <published>2018-05-24T08:07:33.000Z</published>
    <updated>2018-05-24T09:50:03.234Z</updated>
    
    <content type="html"><![CDATA[<blockquote class="blockquote-center"><p>此篇文章只是给里面的代码处做一下详细的讲解~<br>原文地址:loudong.360.cn/School/content/id/285</p></blockquote><p>CTF线下赛中一处代码( 红色区域处 )，现在就是来讲解这个的~<br><img src="http://static.zybuluo.com/1kbfree/utarpdc4wsivh5yzlnihpacr/image_1ce8hrduq1kqieu7kt57qo17mj9.png" alt="image_1ce8hrduq1kqieu7kt57qo17mj9.png-33.3kB"></p><h2 id="讲解开始"><a href="#讲解开始" class="headerlink" title="讲解开始:"></a>讲解开始:</h2><p>首先看一下我写的这个代码:<br><img src="http://static.zybuluo.com/1kbfree/d2mpfibd3nhui8m27fbu41yo/image_1ce8htj9h1i8l11pqbhu1tun16s8m.png" alt="image_1ce8htj9h1i8l11pqbhu1tun16s8m.png-99.2kB"><br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">e</span><span class="params">( $str )</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ( is_array( $str ) )&#123; <span class="comment">//如果是列表~</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;"</span>;</span><br><span class="line">        var_dump( $str );</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="keyword">echo</span> $str ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$mylist = [ </span><br><span class="line">    <span class="string">'ctrl'</span> =&gt; ( !<span class="keyword">empty</span>($_GET[<span class="string">'p'</span>]) ? $_GET[<span class="string">'p'</span>] : <span class="string">'blog'</span> ) , <span class="comment">//ctrl的value值：如果get请求的p值不为空，那么就返回get请求的p值，否者返回blog</span></span><br><span class="line">    <span class="string">'template'</span> =&gt; ( !<span class="keyword">empty</span>($_GET[<span class="string">'t'</span>]) ? $_GET[<span class="string">'t'</span>] : <span class="string">'pc'</span> ) <span class="comment">//template的value值：如果get请求的t值不为空，那么就返回get请求的t值，否者返回pc\</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">e( $mylist );</span><br></pre></td></tr></table></figure></p><div class="note primary"><p>这里的<code>!empty($_GET[&#39;p&#39;]) ? $_GET[&#39;p&#39;] : &#39;blog&#39;</code>是三元表达式，详细用法我也在代码处讲解过了</p></div><h3 id="实验一下代码功能："><a href="#实验一下代码功能：" class="headerlink" title="实验一下代码功能："></a>实验一下代码功能：</h3><p><img src="http://static.zybuluo.com/1kbfree/fttlcckmsujfj51kx8w604gg/image_1ce8i4heebh715oe3p410o7epc9.png" alt="image_1ce8i4heebh715oe3p410o7epc9.png-83.8kB"><br><em>如果没有添加任何值的话，默认的就是ctrl的值为blog,template的值为pc</em></p><h4 id="我们传递一下GET请求的p值和GET请求的t值"><a href="#我们传递一下GET请求的p值和GET请求的t值" class="headerlink" title="我们传递一下GET请求的p值和GET请求的t值:"></a>我们传递一下<code>GET请求的p值</code>和<code>GET请求的t值</code>:</h4><p><img src="http://static.zybuluo.com/1kbfree/yy85lf6qhabol733jjgb233o/image_1ce8idtit131p1mjr1abc1lngs1a1j.png" alt="image_1ce8idtit131p1mjr1abc1lngs1a1j.png-140.4kB"></p><p><img src="http://static.zybuluo.com/1kbfree/5onny736jjn5dx6y2ftao8a0/image_1ce8ibrda1vb11drk5vr8iju2216.png" alt="image_1ce8ibrda1vb11drk5vr8iju2216.png-162.5kB"></p><div class="note success"><p>如果你们觉得这篇文章有点水的话… 那也确实是，哈哈哈(太基础)，但是我只是想来做一篇文章来摆设摆设~</p></div> <blockquote class="blockquote-center"><p>十年寒窗如一日，一举成名天下知<br>                                – cai_team</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;p&gt;此篇文章只是给里面的代码处做一下详细的讲解~&lt;br&gt;原文地址:loudong.360.cn/School/content/id/285&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;CTF线下赛中一处代
      
    
    </summary>
    
      <category term="Web攻防" scheme="127.0.0.1/categories/Web%E6%94%BB%E9%98%B2/"/>
    
    
      <category term="代码审计" scheme="127.0.0.1/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
      <category term="PHP" scheme="127.0.0.1/tags/PHP/"/>
    
  </entry>
  
</feed>
